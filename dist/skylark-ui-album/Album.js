/**
 * skylark-ui-album - The skylark album widgets.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["skylark-langx/skylark","skylark-langx/langx","skylark-utils/noder","skylark-utils/widgets"],function(t,e,i,r){var s={views:[],items:[]},o=r.Widget.inherit({klassName:"Album",options:{typeProperty:"type",titleProperty:"title",altTextProperty:"alt",urlProperty:"href",srcsetProperty:"urlset"},init:function(t,i){this.$el=$(t),this.el=this.$el[0],this.options=e.mixin({},o.prototype.options,i),this._itemFactories={},this.items=this.options.items,this.setViewMode(this.options.view.mode,this.options.view.options)},setViewMode:function(t,e){this.viewMode=t;for(var i=0;i<s.views.length;i++)if(s.views[i].name===t){this.view=new s.views[i].ctor(this,e);break}},getItemUrl:function(t){return o.getItemProperty(t,this.options.urlProperty)},getItemTitle:function(t){return o.getItemProperty(t,this.options.titleProperty)},addItems:function(t){t.concat||(t=Array.prototype.slice.call(t)),this.items.concat||(this.items=Array.prototype.slice.call(this.items)),this.items=this.items.concat(t),this.num=this.items.length,this.trigger("itemsChanged")},renderItem:function(t,e){var i=t&&o.getItemProperty(t,this.options.typeProperty);i&&(i=i.split("/")[0]),i||(i="image");var r=this._itemFactories[i];if(!r)for(var n=0;n<s.items.length;n++)if(s.items[n].mimeType===i){r=this._itemFactories[i]=new s.items[n].ctor(this);break}if(!r)throw new Error("invalid type:"+i);var a=r.render(t,e),l=o.getItemProperty(t,this.options.srcsetProperty);return l&&a.setAttribute("srcset",l),a},isRunnable:function(t){},playItem:function(t){}});e.mixin(o,{getNestedProperty:function(t,e){return e.replace(/\[(?:'([^']+)'|"([^"]+)"|(\d+))\]|(?:(?:^|\.)([^\.\[]+))/g,function(e,i,r,s,o){var n=o||i||r||s&&parseInt(s,10);e&&t&&(t=t[n])}),t},getDataProperty:function(t,e){var i,r;if(t.dataset?(i=e.replace(/-([a-z])/g,function(t,e){return e.toUpperCase()}),r=t.dataset[i]):t.getAttribute&&(r=t.getAttribute("data-"+e.replace(/([A-Z])/g,"-$1").toLowerCase())),"string"==typeof r){if(/^(true|false|null|-?\d+(\.\d+)?|\{[\s\S]*\}|\[[\s\S]*\])$/.test(r))try{return $.parseJSON(r)}catch(s){}return r}},getItemProperty:function(t,e){var i=this.getDataProperty(t,e);return void 0===i&&(i=t[e]),void 0===i&&(i=this.getNestedProperty(t,e)),i}});var n=o.ViewBase=e.Evented.inherit({klassName:"ViewBase",options:{controlsClass:"skylarkui-album-controls",fullScreen:!1},init:function(t,e){var r,s=this;this.album=t,this.initOptions(e),this.options.fullScreen&&i.fullScreen(this.container[0]),this.album.on("item.running",function(t){s.container.hasClass(s.options.controlsClass)?(r=!0,s.container.removeClass(s.options.controlsClass)):r=!1}),this.album.on("item.running",function(t){r&&s.container.addClass(s.options.controlsClass)})},initOptions:function(t){this.options=e.mixin({},n.prototype.options,t)},close:function(){i.fullScreen()===this.container[0]&&i.fullScreen(!1)}}),a=o.ItemFactoryBase=e.Evented.inherit({klassName:"ItemFactoryBase",options:{typeProperty:"type",titleProperty:"title",altTextProperty:"alt",urlProperty:"href",srcsetProperty:"urlset"},init:function(t,e){this.album=t,this.initOptions(e)},initOptions:function(t){this.options=e.mixin({},a.prototype.options,t)},setTimeout:function(t,e,i){var r=this;return t&&window.setTimeout(function(){t.apply(r,e||[])},i||0)},getNestedProperty:o.getNestedProperty,getDataProperty:o.getDataProperty,getItemProperty:o.getItemProperty});o.installPlugin=function(t,e){var i=s[t];if(!i)throw new Error("Invalid paramerter!");i.push(e)};var l=t.ui=t.ui||{};return l.Album=o});
//# sourceMappingURL=sourcemaps/Album.js.map
