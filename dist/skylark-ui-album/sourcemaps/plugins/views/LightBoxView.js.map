{"version":3,"sources":["plugins/views/LightBoxView.js"],"names":["define","langx","Album","SliderView","LightBoxView","inherit","klassName","options","hidePageScrollbars","indicatorContainer","activeIndicatorClass","thumbnailProperty","thumbnailIndicators","initOptions","mixin","prototype","this","overrided","createIndicator","obj","thumbnailUrl","thumbnail","album","indicator","indicatorPrototype","cloneNode","title","getItemTitle","getItemProperty","undefined","getElementsByTagName","$","find","src","style","backgroundImage","addIndicator","index","length","list","setAttribute","appendChild","indicators","push","setActiveIndicator","activeIndicator","removeClass","addClass","initSlides","reload","container","document","createElement","children","addSlide","resetSlides","empty","handleClick","event","target","srcElement","parent","parentNode","preventDefault","slide","getNodeIndex","handleSlide","handleClose","installPlugin","name","ctor","templates","default"],"mappings":";;;;;;;AAAAA,QACE,sBACA,cACA,gBACA,SAAUC,EAAMC,EAAMC,GAEvB,GAAIC,GAAeD,EAAWE,SAC7BC,UAAY,eACZC,SAEOC,oBAAoB,EAGvBC,mBAAoB,KAEpBC,qBAAsB,SAGtBC,kBAAmB,YAEnBC,qBAAqB,GAItBC,YAAa,SAAUN,GACtB,GAAIA,GAAUN,EAAMa,SAASV,EAAaW,UAAUR,QAAQA,EAC/DS,MAAKC,UAAUV,IAGbW,gBAAiB,SAAUC,GACzB,GAIIC,GACAC,EALAC,EAAQN,KAAKM,MACfC,EAAYP,KAAKQ,mBAAmBC,WAAU,GAC5CC,EAAQJ,EAAMK,aAAaR,GAC3BR,EAAoBK,KAAKT,QAAQI,iBAoBrC,OAjBIK,MAAKT,QAAQK,sBACXD,IACFS,EAAelB,EAAM0B,gBAAgBT,EAAKR,IAEvBkB,SAAjBT,IACFC,EAAYF,EAAIW,sBAAwBC,EAAEZ,GAAKa,KAAK,OAAO,GACvDX,IACFD,EAAeC,EAAUY,MAGzBb,IACFG,EAAUW,MAAMC,gBAAkB,QAAUf,EAAe,OAG3DM,IACFH,EAAUG,MAAQA,GAEbH,GAGTa,aAAc,SAAUC,GACtB,GAAIrB,KAAKP,mBAAmB6B,OAAQ,CAClC,GAAIf,GAAYP,KAAKE,gBAAgBF,KAAKuB,KAAKF,GAC/Cd,GAAUiB,aAAa,aAAcH,GACrCrB,KAAKP,mBAAmB,GAAGgC,YAAYlB,GACvCP,KAAK0B,WAAWC,KAAKpB,KAIzBqB,mBAAoB,SAAUP,GACxBrB,KAAK0B,aACH1B,KAAK6B,iBACP7B,KAAK6B,gBAAgBC,YAAY9B,KAAKT,QAAQG,sBAEhDM,KAAK6B,gBAAkBd,EAAEf,KAAK0B,WAAWL,IACzCrB,KAAK6B,gBAAgBE,SAAS/B,KAAKT,QAAQG,wBAI/CsC,WAAY,SAAUC,GACfA,IACHjC,KAAKP,mBAAqBO,KAAKkC,UAAUlB,KACvChB,KAAKT,QAAQE,oBAEXO,KAAKP,mBAAmB6B,SAC1BtB,KAAKQ,mBAAqB2B,SAASC,cAAc,MACjDpC,KAAK0B,WAAa1B,KAAKP,mBAAmB,GAAG4C,WAGjDrC,KAAKC,UAAUgC,IAGjBK,SAAU,SAAUjB,GAClBrB,KAAKC,UAAUoB,GACfrB,KAAKoB,aAAaC,IAGpBkB,YAAa,WACZvC,KAAKC,YACLD,KAAKP,mBAAmB+C,QACxBxC,KAAK0B,eAGNe,YAAa,SAAUC,GACrB,GAAIC,GAASD,EAAMC,QAAUD,EAAME,WAC/BC,EAASF,EAAOG,UACpB,IAAID,IAAW7C,KAAKP,mBAAmB,GAErCO,KAAK+C,eAAeL,GACpB1C,KAAKgD,MAAMhD,KAAKiD,aAAaN,QACxB,CAAA,GAAIE,EAAOC,aAAe9C,KAAKP,mBAAmB,GAKvD,MAAOO,MAAKC,UAAUyC,EAHtB1C,MAAK+C,eAAeL,GACpB1C,KAAKgD,MAAMhD,KAAKiD,aAAaJ,MAMjCK,YAAa,SAAU7B,GACrBrB,KAAKC,UAAUoB,GACfrB,KAAK4B,mBAAmBP,IAG1B8B,YAAa,WACPnD,KAAK6B,iBACP7B,KAAK6B,gBAAgBC,YAAY9B,KAAKT,QAAQG,sBAEhDM,KAAKC,cAmBX,OAdAf,GAAMkE,cAAc,SACnBC,KAAU,WACVC,KAAUlE,EACVmE,WACCC,UAAY,kJAUPpE","file":"../../../plugins/views/LightBoxView.js","sourcesContent":["define([\r\n  'skylark-langx/langx',\r\n  '../../Album',\r\n  './SliderView'\r\n],function (langx,Album,SliderView) {\r\n\r\n\tvar LightBoxView = SliderView.inherit({\r\n\t\tklassName : \"LightBoxView\",\r\n\t\toptions : {\r\n\t        // Hide the page scrollbars:\r\n\t        hidePageScrollbars: false,\r\n\r\n\t\t    // The tag name, Id, element or querySelector of the indicator container:\r\n\t\t    indicatorContainer: 'ol',\r\n\t\t    // The class for the active indicator:\r\n\t\t    activeIndicatorClass: 'active',\r\n\t\t    // The list object property (or data attribute) with the thumbnail URL,\r\n\t\t    // used as alternative to a thumbnail child element:\r\n\t\t    thumbnailProperty: 'thumbnail',\r\n\t\t    // Defines if the gallery indicators should display a thumbnail:\r\n\t\t    thumbnailIndicators: true\r\n\t\t},\r\n\r\n\r\n\t    initOptions: function (options) {\r\n\t    \tvar options = langx.mixin({},LightBoxView.prototype.options,options);\r\n\t\t\tthis.overrided(options);\r\n\t    },\r\n\r\n\t    createIndicator: function (obj) {\r\n\t      var album = this.album,\r\n\t      \t\tindicator = this.indicatorPrototype.cloneNode(false)\r\n\t      var title = album.getItemTitle(obj)\r\n\t      var thumbnailProperty = this.options.thumbnailProperty\r\n\t      var thumbnailUrl\r\n\t      var thumbnail\r\n\t      if (this.options.thumbnailIndicators) {\r\n\t        if (thumbnailProperty) {\r\n\t          thumbnailUrl = Album.getItemProperty(obj, thumbnailProperty)\r\n\t        }\r\n\t        if (thumbnailUrl === undefined) {\r\n\t          thumbnail = obj.getElementsByTagName && $(obj).find('img')[0]\r\n\t          if (thumbnail) {\r\n\t            thumbnailUrl = thumbnail.src\r\n\t          }\r\n\t        }\r\n\t        if (thumbnailUrl) {\r\n\t          indicator.style.backgroundImage = 'url(\"' + thumbnailUrl + '\")'\r\n\t        }\r\n\t      }\r\n\t      if (title) {\r\n\t        indicator.title = title;\r\n\t      }\r\n\t      return indicator;\r\n\t    },\r\n\r\n\t    addIndicator: function (index) {\r\n\t      if (this.indicatorContainer.length) {\r\n\t        var indicator = this.createIndicator(this.list[index])\r\n\t        indicator.setAttribute('data-index', index)\r\n\t        this.indicatorContainer[0].appendChild(indicator)\r\n\t        this.indicators.push(indicator)\r\n\t      }\r\n\t    },\r\n\r\n\t    setActiveIndicator: function (index) {\r\n\t      if (this.indicators) {\r\n\t        if (this.activeIndicator) {\r\n\t          this.activeIndicator.removeClass(this.options.activeIndicatorClass)\r\n\t        }\r\n\t        this.activeIndicator = $(this.indicators[index])\r\n\t        this.activeIndicator.addClass(this.options.activeIndicatorClass)\r\n\t      }\r\n\t    },\r\n\r\n\t    initSlides: function (reload) {\r\n\t      if (!reload) {\r\n\t        this.indicatorContainer = this.container.find(\r\n\t          this.options.indicatorContainer\r\n\t        )\r\n\t        if (this.indicatorContainer.length) {\r\n\t          this.indicatorPrototype = document.createElement('li')\r\n\t          this.indicators = this.indicatorContainer[0].children\r\n\t        }\r\n\t      }\r\n\t      this.overrided(reload);\r\n\t    },\r\n\r\n\t    addSlide: function (index) {\r\n\t      this.overrided(index);\r\n\t      this.addIndicator(index)\r\n\t    },\r\n\r\n\t    resetSlides: function () {\r\n\t    \tthis.overrided();\r\n\t    \tthis.indicatorContainer.empty();\r\n\t    \tthis.indicators = [];\r\n\t    },\r\n\r\n\t    handleClick: function (event) {\r\n\t      var target = event.target || event.srcElement\r\n\t      var parent = target.parentNode\r\n\t      if (parent === this.indicatorContainer[0]) {\r\n\t        // Click on indicator element\r\n\t        this.preventDefault(event)\r\n\t        this.slide(this.getNodeIndex(target))\r\n\t      } else if (parent.parentNode === this.indicatorContainer[0]) {\r\n\t        // Click on indicator child element\r\n\t        this.preventDefault(event)\r\n\t        this.slide(this.getNodeIndex(parent))\r\n\t      } else {\r\n\t        return this.overrided(event)\r\n\t      }\r\n\t    },\r\n\r\n\t    handleSlide: function (index) {\r\n\t      this.overrided(index)\r\n\t      this.setActiveIndicator(index)\r\n\t    },\r\n\r\n\t    handleClose: function () {\r\n\t      if (this.activeIndicator) {\r\n\t        this.activeIndicator.removeClass(this.options.activeIndicatorClass)\r\n\t      }\r\n\t      this.overrided();\r\n\t    }\r\n\r\n\t});\r\n\r\n\tAlbum.installPlugin(\"views\",{\r\n\t\t\"name\" :  \"lightbox\",\r\n\t\t\"ctor\" :  LightBoxView,\r\n\t\t\"templates\" : {\r\n\t\t\t\"default\" : '<div class=\"slides\"></div>' +\r\n\t\t\t          '<h3 class=\"title\"></h3>' +\r\n\t\t\t          '<a class=\"prev\">‹</a>' +\r\n\t\t\t          '<a class=\"next\">›</a>' +\r\n\t\t\t          '<a class=\"close\">×</a>' + \r\n\t\t\t          '<ol class=\"indicator\"></ol>'\r\n\r\n\t\t} \r\n\t});\r\n\r\n\treturn LightBoxView;\r\n\r\n});"]}