/**
 * skylark-ui-album - The skylark album widgets.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
!function(t,e){function i(t,e){if("."!==t[0])return t;var i=e.split("/"),n=t.split("/");i.pop();for(var r=0;r<n.length;r++)"."!=n[r]&&(".."==n[r]?i.pop():i.push(n[r]));return i.join("/")}var n=e.define,r=e.require,o="function"==typeof n&&n.amd,s=!o&&"undefined"!=typeof exports;if(!o&&!n){var a={};n=e.define=function(t,e,n){"function"==typeof n?(a[t]={factory:n,deps:e.map(function(e){return i(e,t)}),exports:null},r(t)):a[t]=n},r=e.require=function(t){if(!a.hasOwnProperty(t))throw new Error("Module "+t+" has not been defined");var e=a[t];if(!e.exports){var i=[];e.deps.forEach(function(t){i.push(r(t))}),e.exports=e.factory.apply(window,i)}return e.exports}}if(!n)throw new Error("The module utility (ex: requirejs or skylark-utils) is not loaded!");if(t(n,r),!o){var l=r("skylark-langx/skylark");s?exports=l:e.skylarkjs=l}}(function(define,require){define("skylark-langx/skylark",[],function(){var t={};return t}),define("skylark-langx/types",[],function(){function t(t){return t&&t.constructor===Array}function e(t){return!h(t)&&!a(t)&&"number"==typeof t.length&&!s(t)}function i(t){return"boolean"==typeof t}function n(t){return"undefined"!=typeof t}function r(t){return null!=t&&t.nodeType==t.DOCUMENT_NODE}function o(t){var e;for(e in t)if(null!==t[e])return!1;return!0}function s(t){return"function"==p(t)}function a(t){return t&&t instanceof Node}function l(t){return"number"==typeof t}function u(t){return"object"==p(t)}function c(t){return u(t)&&!d(t)&&Object.getPrototypeOf(t)==Object.prototype}function h(t){return"string"==typeof t}function d(t){return t&&t==t.window}function f(t){if(t){var e=location.protocol+"//"+location.hostname;return location.port&&(e+=":"+location.port),t.startsWith(e)}}var p=function(){var t={};return"Boolean Number String Function Array Date RegExp Object Error".split(" ").forEach(function(e){t["[object "+e+"]"]=e.toLowerCase()}),function(e){return null==e?String(e):t[toString.call(e)]||"object"}}();return{isArray:t,isArrayLike:e,isBoolean:i,isDefined:n,isDocument:r,isEmptyObject:o,isFunction:s,isHtmlNode:a,isNumber:l,isObject:u,isPlainObject:c,isString:h,isSameOrigin:f,isWindow:d,type:p}}),define("skylark-langx/arrays",["./types"],function(t){function e(t){return l.call(t,function(t){return null!=t})}function i(t,e){var i,n,r,o,s;if(t)if(i=t.length,i===o){for(n in t)if(t.hasOwnProperty(n)&&(s=t[n],e.call(s,n,s)===!1))break}else for(r=0;r<i&&(s=t[r],e.call(s,r,s)!==!1);r++);return this}function n(t){if(u(t)){for(var e=[],i=0;i<t.length;i++){var n=t[i];if(u(n))for(var r=0;r<n.length;r++)e.push(n[r]);else e.push(n)}return e}return t}function r(t,e){if(!e)return-1;var i;if(e.indexOf)return e.indexOf(t);for(i=e.length;i--;)if(e[i]===t)return i;return-1}function o(t,e,i){return u(t)?(i||[]).concat(Array.prototype.slice.call(t,e||0)):[t]}function s(t,e){var i,r,o,s=[];if(u(t))for(r=0;r<t.length;r++)i=e.call(t[r],t[r],r),null!=i&&s.push(i);else for(o in t)i=e.call(t[o],t[o],o),null!=i&&s.push(i);return n(s)}function a(t){return l.call(t,function(e,i){return t.indexOf(e)==i})}var l=Array.prototype.filter,u=t.isArrayLike;return{compact:e,first:function(t,e){return e?t.slice(0,e):t[0]},each:i,flatten:n,inArray:r,makeArray:o,map:s,uniq:a}}),define("skylark-langx/objects",["./types"],function(t){function e(t,e){return function(i){var n=arguments.length;if(e&&(i=Object(i)),n<2||null==i)return i;for(var r=1;r<n;r++)for(var o=arguments[r],s=t(o),a=s.length,l=0;l<a;l++){var u=s[l];e&&void 0!==i[u]||(i[u]=o[u])}return i}}function i(t){if(!k(t))return[];var e=[];for(var i in t)e.push(i);return e}function n(t){if(k(t))return[];var e=[];for(var i in t)r(t,i)&&e.push(i);return e}function r(t,e){if(!C(e))return null!=t&&y.call(t,e);for(var i=e.length,n=0;n<i;n++){var r=e[n];if(null==t||!y.call(t,r))return!1;t=t[r]}return!!i}function o(t,e){return m(t,e)}function s(t,e){var i=i(e),n=i.length;if(null==t)return!n;for(var r=Object(t),o=0;o<n;o++){var s=i[o];if(e[s]!==r[s]||!(s in r))return!1}return!0}function a(t,e,i,n){for(var r in e)n&&void 0!==t[r]||(i&&(x(e[r])||C(e[r]))?(x(e[r])&&!x(t[r])&&(t[r]={}),C(e[r])&&!C(t[r])&&(t[r]=[]),a(t[r],e[r],i,n)):void 0!==e[r]&&(t[r]=e[r]));return t}function l(t){var e=g.call(arguments,0),i=e.shift(),n=!1;return b(e[e.length-1])&&(n=e.pop()),{target:i,sources:e,deep:n}}function u(){var t=l.apply(this,arguments);return t.sources.forEach(function(e){a(t.target,e,t.deep,!1)}),t.target}function c(t,e){if(C(t)){var i=t.indexOf(e);i!=-1&&t.splice(i,1)}else if(x(t))for(var n in t)if(t[n]==e){delete t[n];break}return this}function h(t,e,i){C(e)||(e=[e]);var n=e.length;if(!n)return w(i)?i.call(t):i;for(var r=0;r<n;r++){var o=null==t?void 0:t[e[r]];void 0===o&&(o=i,r=n),t=w(o)?o.call(t):o}return t}function d(){var t=l.apply(this,arguments);return t.sources.forEach(function(e){a(t.target,e,t.deep,!0)}),t.target}function f(t){for(var e=_.keys(t),i=e.length,n=Array(i),r=0;r<i;r++)n[r]=t[e[r]];return n}function p(t,e){var i;if(void 0===t||null===t)i=t;else if(e&&t.clone)i=t.clone();else if(C(t)){i=[];for(var n=0;n<t.length;n++)i.push(p(t[n]))}else if(x(t)){i={};for(var r in t)i[r]=p(t[r])}else i=t;return i}var m,v,y=Object.prototype.hasOwnProperty,g=Array.prototype.slice,b=t.isBoolean,w=t.isFunction,k=t.isObject,x=t.isPlainObject,C=t.isArray,E="undefined"!=typeof Symbol?Symbol.prototype:null;return m=function(t,e,i,n){if(t===e)return 0!==t||1/t===1/e;if(null==t||null==e)return!1;if(t!==t)return e!==e;var r=typeof t;return("function"===r||"object"===r||"object"==typeof e)&&v(t,e,i,n)},v=function(t,e,i,n){var r=toString.call(t);if(r!==toString.call(e))return!1;switch(r){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!==+t?+e!==+e:0===+t?1/+t===1/e:+t===+e;case"[object Date]":case"[object Boolean]":return+t===+e;case"[object Symbol]":return E.valueOf.call(t)===E.valueOf.call(e)}var o="[object Array]"===r;if(!o){if("object"!=typeof t||"object"!=typeof e)return!1;var s=t.constructor,a=e.constructor;if(s!==a&&!(w(s)&&s instanceof s&&w(a)&&a instanceof a)&&"constructor"in t&&"constructor"in e)return!1}i=i||[],n=n||[];for(var l=i.length;l--;)if(i[l]===t)return n[l]===e;if(i.push(t),n.push(e),o){if(l=t.length,l!==e.length)return!1;for(;l--;)if(!m(t[l],e[l],i,n))return!1}else{var u,c=Object.keys(t);if(l=c.length,Object.keys(e).length!==l)return!1;for(;l--;)if(u=c[l],void 0===e[u]||!m(t[u],e[u],i,n))return!1}return i.pop(),n.pop(),!0},{allKeys:i,clone:p,defaults:e(i,!0),has:r,isEqual:o,isMatch:s,keys:n,mixin:u,removeItem:c,result:h,safeMixin:d,values:f}}),define("skylark-langx/klass",["./arrays","./objects","./types"],function(t,e,i){var n=t.uniq,r=e.has,o=e.mixin,s=i.isArray,a=i.isDefined,l=function(){function t(t,e,i){var n=t.prototype,r=t.superclass.prototype,o=i&&i.noOverrided;for(var s in e)if("constructor"!==s){var a=e[s];"function"==typeof e[s]?n[s]=a._constructor||o||"function"!=typeof r[s]?a:function(t,e,i){return function(){var t=this.overrided;this.overrided=i;var n=e.apply(this,arguments);return this.overrided=t,n}}(s,a,r[s]):"object"==typeof a&&null!==a&&a.get?Object.defineProperty(n,s,a):n[s]=a}return t}function e(t,e){var i=[];return e.forEach(function(t){if(r(t,"__mixins__"))throw new Error("nested mixins");for(var e=[];t;)e.unshift(t),t=t.superclass;i=i.concat(e)}),i=n(i),i=i.filter(function(e){for(var i=t;i;){if(e===i)return!1;if(r(i,"__mixins__"))for(var n=i.__mixins__,o=0;o<n.length;o++)if(n[o]===e)return!1;i=i.superclass}return!0}),i.length>0&&i}function i(t,e){for(var i=t,n=0;n<e.length;n++){var r=new Function;r.prototype=Object.create(i.prototype),r.__proto__=i,r.superclass=null,o(r.prototype,e[n].prototype),r.prototype.__mixin__=e[n],i=r}return i}return function l(n,r,o,u){s(r)&&(u=o,o=r,r=null),r=r||Object,a(o)&&!s(o)&&(u=o,o=!1);var c=r;o&&(o=e(c,o)),o&&(c=i(c,o));var h=n.constructor;h===Object&&(h=function(){if(this.init)return this.init.apply(this,arguments)});var d=n.klassName||"",f=new Function("return function "+d+"() {var inst = this, ctor = arguments.callee;if (!(inst instanceof ctor)) {inst = Object.create(ctor.prototype);}return ctor._constructor.apply(inst, arguments) || inst;}")();return f._constructor=h,f.prototype=Object.create(c.prototype),f.prototype.constructor=f,f.superclass=r,f.__proto__=c,o&&(f.__mixins__=o),f.partial||(f.partial=function(e,i){return t(this,e,i)}),f.inherit||(f.inherit=function(t,e,i){return l(t,this,e,i)}),f.partial(n,u),f}},u=l();return u}),define("skylark-langx/ArrayStore",["./klass"],function(t){var e=function(t,e){function i(t,e,i){var n,r=0,o=t&&t.length||0,s=[];if(o&&"string"==typeof t&&(t=t.split("")),"string"==typeof e&&(e=cache[e]||buildFn(e)),i)for(;r<o;++r)n=t[r],e.call(i,n,r,t)&&s.push(n);else for(;r<o;++r)n=t[r],e(n,r,t)&&s.push(n);return s}function n(n){var r=i(n,t),o=e&&e.sort;if(o&&r.sort("function"==typeof o?o:function(t,e){for(var i,n=0;i=o[n];n++){var r=t[i.attribute],s=e[i.attribute];if(r=null!=r?r.valueOf():r,s=null!=s?s.valueOf():s,r!=s)return!!i.descending==(null==r||r>s)?-1:1}return 0}),e&&(e.start||e.count)){var s=r.length;r=r.slice(e.start||0,(e.start||0)+(e.count||1/0)),r.total=s}return r}switch(typeof t){default:throw new Error("Can not query with a "+typeof t);case"object":case"undefined":var r=t;t=function(t){for(var e in r){var i=r[e];if(i&&i.test){if(!i.test(t[e],t))return!1}else if(i!=t[e])return!1}return!0};break;case"string":if(!this[t])throw new Error("No filter function "+t+" was found in store");t=this[t];case"function":}return n.matches=t,n},i=function(t){function e(e){t[e]=function(){var r=arguments,o=Deferred.when(t,function(t){return i(Array.prototype[e].apply(t,r))});if("forEach"!==e||n)return o}}if(!t)return t;var n=!!t.then;return n&&(t=Object.delegate(t)),e("forEach"),e("filter"),e("map"),null==t.total&&(t.total=Deferred.when(t,function(t){return t.length})),t},n=t({klassName:"ArrayStore",queryEngine:e,idProperty:"id",get:function(t){return this.data[this.index[t]]},getIdentity:function(t){return t[this.idProperty]},put:function(t,e){var i=this.data,n=this.index,r=this.idProperty,o=t[r]=e&&"id"in e?e.id:r in t?t[r]:Math.random();if(o in n){if(e&&e.overwrite===!1)throw new Error("Object already exists");i[n[o]]=t}else n[o]=i.push(t)-1;return o},add:function(t,e){return(e=e||{}).overwrite=!1,this.put(t,e)},remove:function(t){var e=this.index,i=this.data;if(t in e)return i.splice(e[t],1),this.setData(i),!0},query:function(t,e){return i(this.queryEngine(t,e)(this.data))},setData:function(t){t.items?(this.idProperty=t.identifier||this.idProperty,t=this.data=t.items):this.data=t,this.index={};for(var e=0,i=t.length;e<i;e++)this.index[t[e][this.idProperty]]=e},init:function(t){for(var e in t)this[e]=t[e];this.setData(this.data||[])}});return n}),define("skylark-langx/aspect",[],function(){function t(t,e,i,r){var o,s=t[e],a="around"==e;if(a){var l=i(function(){return s.advice(this,arguments)});o={remove:function(){l&&(l=t=i=null)},advice:function(t,e){return l?l.apply(t,e):s.advice(t,e)}}}else o={remove:function(){if(o.advice){var n=o.previous,r=o.next;r||n?(n?n.next=r:t[e]=r,r&&(r.previous=n)):delete t[e],t=i=o.advice=null}},id:n++,advice:i,receiveArguments:r};if(s&&!a)if("after"==e){for(;s.next&&(s=s.next););s.next=o,o.previous=s}else"before"==e&&(t[e]=o,o.next=s,s.previous=o);else t[e]=o;return o}function e(e){return function(r,o,s,a){var l,u=r[o];u&&u.target==r||(r[o]=l=function(){for(var t=n,e=arguments,r=l.before;r;)e=r.advice.apply(this,e)||e,r=r.next;if(l.around)var o=l.around.advice(this,e);for(var s=l.after;s&&s.id<t;){if(s.receiveArguments){var a=s.advice.apply(this,e);o=a===i?o:a}else o=s.advice.call(this,o,e);s=s.next}return o},u&&(l.around={advice:function(t,e){return u.apply(t,e)}}),l.target=r);var c=t(l||u,e,s,a);return s=null,c}}var i,n=0;return{after:e("after"),around:e("around"),before:e("before")}}),define("skylark-langx/funcs",["./objects","./types"],function(t,e){function i(t){return requestAnimationFrame?requestAnimationFrame(t):setTimeoutout(t),this}function n(){}function r(t,e){var i=2 in arguments&&slice.call(arguments,2);if(a(t)){var n=function(){return t.apply(e,i?i.concat(slice.call(arguments)):arguments)};return n}if(l(e))return i?(i.unshift(t[e],t),r.apply(null,i)):r(t[e],t);throw new TypeError("expected function")}function o(t,e){var i;return function(){var n=this,r=arguments,o=function(){i=null,t.apply(n,r)};i&&clearTimeout(i),i=setTimeout(o,e)}}var s=t.mixin,a=e.isFunction,l=e.isString,u=function(){function t(){}return function(e,i){t.prototype=e;var n=new t;return t.prototype=null,i&&s(n,i),n}}();return{debounce:o,delegate:u,defer:i,noop:n,proxy:r,returnTrue:function(){return!0},returnFalse:function(){return!1}}}),define("skylark-langx/Deferred",["./arrays","./funcs","./objects"],function(t,e,i){"use strict";function n(t,e){var i={state:function(){return e.isResolved()?"resolved":e.isRejected()?"rejected":"pending"},then:function(t,e,n){return n&&this.progress(n),u(Promise.prototype.then.call(this,t&&function(e){return e&&void 0!==e.__ctx__?t.apply(e.__ctx__,e):t(e)},e&&function(t){return t&&void 0!==t.__ctx__?e.apply(t.__ctx__,t):e(t)}),i)},progress:function(t){return e[r].push(t),this}};return i.pipe=i.then,u(t,i)}var r=Symbol?Symbol():"__pglisteners",o=Array.prototype.slice,s=e.proxy,a=t.makeArray,l=i.result,u=i.mixin;u(Promise.prototype,{always:function(t){return this.then(t,t),this},done:function(t){return this.then(t),this},fail:function(t){return this["catch"](t),this}});var c=function(){var t=this,e=this.promise=new Promise(function(e,i){t._resolve=e,t._reject=i});n(e,t),this[r]=[]};return c.prototype.resolve=function(t){var e=o.call(arguments);return this.resolveWith(null,e)},c.prototype.resolveWith=function(t,e){return e=e?a(e):[],e.__ctx__=t,this._resolve(e),this._resolved=!0,this},c.prototype.progress=function(t){try{return this[r].forEach(function(e){return e(t)})}catch(e){this.reject(e)}return this},c.prototype.reject=function(t){var e=o.call(arguments);return this.rejectWith(null,e)},c.prototype.rejectWith=function(t,e){return e=e?a(e):[],e.__ctx__=t,this._reject(e),this._rejected=!0,this},c.prototype.isResolved=function(){return!!this._resolved},c.prototype.isRejected=function(){return!!this._rejected},c.prototype.then=function(t,e,i){var n=l(this,"promise");return n.then(t,e,i)},c.prototype.done=c.prototype.then,c.all=function(t){return n(Promise.all(t))},c.first=function(t){return n(Promise.race(t))},c.when=function(t,e,i,n){var r=t&&"function"==typeof t.then,o=r&&t instanceof Promise;if(!r)return arguments.length>1?e?e(t):t:(new c).resolve(t);if(!o){var a=new c(t.cancel);t.then(s(a.resolve,a),s(a.reject,a),a.progress),t=a.promise}return e||i||n?t.then(e,i,n):t},c.reject=function(t){var e=new c;return e.reject(t),e.promise},c.resolve=function(t){var e=new c;return e.resolve.apply(e,arguments),e.promise},c.immediate=c.resolve,c}),define("skylark-langx/async",["./Deferred","./arrays"],function(t,e){var i=e.each,n={parallel:function(e,n,r){var o=[];return r=r||null,n=n||[],i(e,function(t,e){o.push(e.apply(r,n))}),t.all(o)},series:function(e,n,r){var o=[],s=new t,a=s.promise;return r=r||null,n=n||[],s.resolve(),i(e,function(t,e){a=a.then(function(){return e.apply(r,n)}),o.push(a)}),t.all(o)},waterful:function(e,n,r){var o=new t,s=o.promise;return r=r||null,n=n||[],o.resolveWith(r,n),i(e,function(t,e){s=s.then(e)}),s}};return n}),define("skylark-langx/Evented",["./klass","./objects","./types"],function(t,e,i){var n=Array.prototype.slice,r=i.isDefined,o=i.isPlainObject,s=i.isFunction,a=i.isString,l=i.isEmptyObject,u=e.mixin,c=t({on:function(t,e,i,n,r,l){var u=this,c=this._hub||(this._hub={});return o(t)?(r=n,each(t,function(t,n){u.on(t,e,i,n,r,l)}),this):(a(e)||s(n)||(r=n,n=i,i=e,e=void 0),s(i)&&(r=n,n=i,i=null),a(t)&&(t=t.split(/\s/)),t.forEach(function(t){(c[t]||(c[t]=[])).push({fn:n,selector:e,data:i,ctx:r,one:l})}),this)},one:function(t,e,i,n,r){return this.on(t,e,i,n,r,1)},trigger:function(t){if(!this._hub)return this;var e=this;a(t)&&(t=new CustomEvent(t)),Object.defineProperty(t,"target",{value:this});var i=n.call(arguments,1);return i=r(i)?[t].concat(i):[t],[t.type||t.name,"all"].forEach(function(n){var r=e._hub[n];if(r){for(var o=r.length,s=!1,a=0;a<o;a++){var l=r[a];t.data?l.data&&(t.data=u({},l.data,t.data)):t.data=l.data||null,l.fn.apply(l.ctx,i),l.one&&(r[a]=null,s=!0)}s&&(e._hub[n]=compact(r))}}),this},listened:function(t){var e=(this._hub||(this._events={}))[t]||[];return e.length>0},listenTo:function(t,e,i,n){if(!t)return this;a(i)&&(i=this[i]),n?t.one(e,i,this):t.on(e,i,this);for(var r,o=this._listeningTo||(this._listeningTo=[]),s=0;s<o.length;s++)if(o[s].obj==t){r=o[s];break}r||o.push(r={obj:t,events:{}});var l=r.events,u=l[e]=l[e]||[];return u.indexOf(i)==-1&&u.push(i),this},listenToOnce:function(t,e,i){return this.listenTo(t,e,i,1)},off:function(t,e){var i=this._hub||(this._hub={});return a(t)&&(t=t.split(/\s/)),t.forEach(function(t){var n=i[t],r=[];if(n&&e)for(var o=0,s=n.length;o<s;o++)n[o].fn!==e&&n[o].fn._!==e&&r.push(n[o]);r.length?i[t]=r:delete i[t]}),this},unlistenTo:function(t,e,i){var n=this._listeningTo;if(!n)return this;for(var r=0;r<n.length;r++){var o=n[r];if(!t||t==o.obj){var s=o.events;for(var a in s)if(!e||e==a){for(var u=s[a],c=0;c<u.length;c++)i&&i!=u[r]||(o.obj.off(a,u[r],this),u[r]=null);u=s[a]=compact(u),l(u)&&(s[a]=null)}l(s)&&(n[r]=null)}}return n=this._listeningTo=compact(n),l(n)&&(this._listeningTo=null),this}});return c}),define("skylark-langx/strings",[],function(){function t(t){return t.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function e(t){try{return t?"true"==t||"false"!=t&&("null"==t?null:+t+""==t?+t:/^[\[\{]/.test(t)?JSON.parse(t):t):t}catch(e){return t}}function i(t){return null==t?"":String.prototype.trim.call(t)}function n(t,e,i,n){function r(t,e){if(t.match(/\./)){var i,n=function(t,e){var r=t.pop();return r?e[r]?n(t,i=e[r]):null:i};return n(t.split(".").reverse(),e)}return e[t]}return n=n||window,i=i?proxy(n,i):function(t){return t},t.replace(/\$\{([^\s\:\}]+)(?:\:([^\s\:\}]+))?\}/g,function(t,o,s){var a=r(o,e);return s&&(a=r(s,n).call(n,a,o)),i(a,o).toString()})}return{camelCase:function(t){return t.replace(/-([\da-z])/g,function(t){return t.toUpperCase().replace("-","")})},dasherize:t,deserializeValue:e,lowerFirst:function(t){return t.charAt(0).toLowerCase()+t.slice(1)},serializeValue:function(t){return JSON.stringify(t)},substitute:n,trim:i,upperFirst:function(t){return t.charAt(0).toUpperCase()+t.slice(1)}}}),define("skylark-langx/Xhr",["./arrays","./Deferred","./Evented","./objects","./funcs","./types"],function(arrays,Deferred,Evented,objects,funcs,types){var each=arrays.each,mixin=objects.mixin,noop=funcs.noop,isArray=types.isArray,isFunction=types.isFunction,isPlainObject=types.isPlainObject,type=types.type,getAbsoluteUrl=function(){var t;return function(e){return t||(t=document.createElement("a")),t.href=e,t.href}}(),Xhr=function(){function mimeToDataType(t){if(t&&(t=t.split(";",2)[0]),t){if(t==htmlType)return"html";if(t==jsonType)return"json";if(scriptTypeRE.test(t))return"script";if(xmlTypeRE.test(t))return"xml"}return"text"}function appendQuery(t,e){return""==e?t:(t+"&"+e).replace(/[&?]{1,2}/,"?")}function serializeData(t){t.data=t.data||t.query,t.processData&&t.data&&"string"!=type(t.data)&&(t.data=param(t.data,t.traditional)),!t.data||t.type&&"GET"!=t.type.toUpperCase()||(t.url=appendQuery(t.url,t.data),t.data=void 0)}function serialize(t,e,i,n){var r,o=isArray(e),s=isPlainObject(e);each(e,function(e,a){r=type(a),n&&(e=i?n:n+"["+(s||"object"==r||"array"==r?e:"")+"]"),!n&&o?t.add(a.name,a.value):"array"==r||!i&&"object"==r?serialize(t,a,i,e):t.add(e,a)})}var jsonpID=0,key,name,rscript=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,scriptTypeRE=/^(?:text|application)\/javascript/i,xmlTypeRE=/^(?:text|application)\/xml/i,jsonType="application/json",htmlType="text/html",blankRE=/^\s*$/,XhrDefaultOptions={async:!0,type:"GET",beforeSend:noop,success:noop,error:noop,complete:noop,context:null,global:!0,accepts:{script:"text/javascript, application/javascript, application/x-javascript",json:"application/json",xml:"application/xml, text/xml",html:"text/html",text:"text/plain"},crossDomain:!1,timeout:0,processData:!0,cache:!0,xhrFields:{withCredentials:!0}},param=function(t,e){var i=[];return i.add=function(t,e){isFunction(e)&&(e=e()),null==e&&(e=""),this.push(escape(t)+"="+escape(e))},serialize(i,t,e),i.join("&").replace(/%20/g,"+")},Xhr=Evented.inherit({klassName:"Xhr",_request:function(args){var _=this._,self=this,options=mixin({},XhrDefaultOptions,_.options,args),xhr=_.xhr=new XMLHttpRequest;serializeData(options);var dataType=options.dataType||options.handleAs,mime=options.mimeType||options.accepts[dataType],headers=options.headers,xhrFields=options.xhrFields,isFormData=options.data&&options.data instanceof FormData,basicAuthorizationToken=options.basicAuthorizationToken,type=options.type,url=options.url,async=options.async,user=options.user,password=options.password,deferred=new Deferred,contentType=!isFormData&&"application/x-www-form-urlencoded";if(xhrFields)for(name in xhrFields)xhr[name]=xhrFields[name];mime&&mime.indexOf(",")>-1&&(mime=mime.split(",",2)[0]),mime&&xhr.overrideMimeType&&xhr.overrideMimeType(mime);var finish=function(){xhr.onloadend=noop,xhr.onabort=noop,xhr.onprogress=noop,xhr.ontimeout=noop,xhr=null},onloadend=function(){var result,error=!1;if(xhr.status>=200&&xhr.status<300||304==xhr.status||0==xhr.status&&getAbsoluteUrl(url).startsWith("file:")){dataType=dataType||mimeToDataType(options.mimeType||xhr.getResponseHeader("content-type")),result=xhr.responseText;try{"script"==dataType?eval(result):"xml"==dataType?result=xhr.responseXML:"json"==dataType?result=blankRE.test(result)?null:JSON.parse(result):"blob"==dataType?result=Blob([xhrObj.response]):"arraybuffer"==dataType&&(result=xhr.reponse)}catch(e){error=e}error?deferred.reject(error,xhr.status,xhr):deferred.resolve(result,xhr.status,xhr)}else deferred.reject(new Error(xhr.statusText),xhr.status,xhr);finish()},onabort=function(){deferred&&deferred.reject(new Error("abort"),xhr.status,xhr),finish()},ontimeout=function(){deferred&&deferred.reject(new Error("timeout"),xhr.status,xhr),finish()},onprogress=function(t){deferred&&deferred.progress(t,xhr.status,xhr)};if(xhr.onloadend=onloadend,xhr.onabort=onabort,xhr.ontimeout=ontimeout,xhr.onprogress=onprogress,xhr.open(type,url,async,user,password),headers)for(var key in headers){var value=headers[key];"content-type"===key.toLowerCase()?contentType=headers[hdr]:xhr.setRequestHeader(key,value)}return contentType&&contentType!==!1&&xhr.setRequestHeader("Content-Type",contentType),headers&&"X-Requested-With"in headers||xhr.setRequestHeader("X-Requested-With","XMLHttpRequest"),basicAuthorizationToken&&xhr.setRequestHeader("Authorization",basicAuthorizationToken),xhr.send(options.data?options.data:null),deferred.promise},abort:function(){var t=this._,e=t.xhr;e&&e.abort()},request:function(t){return this._request(t)},get:function(t){return t=t||{},t.type="GET",this._request(t)},post:function(t){return t=t||{},t.type="POST",this._request(t)},patch:function(t){return t=t||{},t.type="PATCH",this._request(t)},put:function(t){return t=t||{},t.type="PUT",this._request(t)},del:function(t){return t=t||{},t.type="DELETE",this._request(t)},init:function(t){this._={options:t||{}}}});return["request","get","post","put","del","patch"].forEach(function(t){Xhr[t]=function(e,i){var n=new Xhr({url:e});return n[t](i)}}),Xhr.defaultOptions=XhrDefaultOptions,Xhr.param=param,Xhr}();return Xhr}),define("skylark-langx/Restful",["./Evented","./objects","./strings","./Xhr"],function(t,e,i,n){var r=e.mixin,o=i.substitute,s=t.inherit({klassName:"Restful",idAttribute:"id",getBaseUrl:function(t){var e=o(this.baseEndpoint,t),i=this.server+this.basePath+e;return void 0!==t[this.idAttribute]&&(i=i+"/"+t[this.idAttribute]),i},_head:function(t){},_get:function(t){return n.get(this.getBaseUrl(t),t)},_post:function(t,e){var i=this.getBaseUrl(t);return e&&(i=i+"/"+e),n.post(i,t)},_put:function(t,e){var i=this.getBaseUrl(t);return e&&(i=i+"/"+e),n.put(i,t)},_delete:function(t){var e=this.getBaseUrl(t);return n.del(e)},_patch:function(t){var e=this.getBaseUrl(t);return n.patch(e,t)},query:function(t){return this._post(t)},retrieve:function(t){return this._get(t)},create:function(t){return this._post(t)},update:function(t){return this._put(t)},"delete":function(t){return this._delete(t)},patch:function(t){return this._patch(t)},init:function(t){r(this,t)}});return s}),define("skylark-langx/Stateful",["./Evented"],function(t){var e=t.inherit({init:function(t,e){var i=t||{};e||(e={}),this.cid=uniqueId(this.cidPrefix),this.attributes={},e.collection&&(this.collection=e.collection),e.parse&&(i=this.parse(i,e)||{});var n=result(this,"defaults");i=mixin({},n,i),this.set(i,e),this.changed={}},changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",toJSON:function(t){return clone(this.attributes)},get:function(t){return this.attributes[t]},has:function(t){return null!=this.get(t)},set:function(t,e,i){if(null==t)return this;var n;if("object"==typeof t?(n=t,i=e):(n={})[t]=e,i||(i={}),!this._validate(n,i))return!1;var r=i.unset,o=i.silent,s=[],a=this._changing;this._changing=!0,a||(this._previousAttributes=clone(this.attributes),this.changed={});var l=this.attributes,u=this.changed,c=this._previousAttributes;for(var h in n)e=n[h],isEqual(l[h],e)||s.push(h),isEqual(c[h],e)?delete u[h]:u[h]=e,r?delete l[h]:l[h]=e;if(this.idAttribute in n&&(this.id=this.get(this.idAttribute)),!o){s.length&&(this._pending=i);for(var d=0;d<s.length;d++)this.trigger("change:"+s[d],this,l[s[d]],i)}if(a)return this;if(!o)for(;this._pending;)i=this._pending,this._pending=!1,this.trigger("change",this,i);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,mixin({},e,{unset:!0}))},clear:function(t){var e={};for(var i in this.attributes)e[i]=void 0;return this.set(e,mixin({},t,{unset:!0}))},hasChanged:function(t){return null==t?!isEmptyObject(this.changed):void 0!==this.changed[t]},changedAttributes:function(t){if(!t)return!!this.hasChanged()&&clone(this.changed);var e=this._changing?this._previousAttributes:this.attributes,i={};for(var n in t){var r=t[n];isEqual(e[n],r)||(i[n]=r)}return!isEmptyObject(i)&&i},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return clone(this._previousAttributes)},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(t){return this._validate({},mixin({},t,{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=mixin({},this.attributes,t);var i=this.validationError=this.validate(t,e)||null;return!i||(this.trigger("invalid",this,i,mixin(e,{validationError:i})),!1)}});return e}),define("skylark-langx/langx",["./skylark","./arrays","./ArrayStore","./aspect","./async","./Deferred","./Evented","./funcs","./klass","./objects","./Restful","./Stateful","./strings","./types","./Xhr"],function(t,e,i,n,r,o,s,a,l,u,c,h,d,f,p){"use strict";function m(t,e){var i=new CustomEvent(t,e);return C(i,e)}function v(t,e,i,n){return E(e)?e.call(t,i,n):e}function y(t){var t=t||window.location.href,e=t.split("?"),i={};return e.length>1&&e[1].split("&").forEach(function(t){var e=t.split("=");i[e[0]]=e[1]}),i}function g(t){return parseFloat(t)||0}function b(t){return t._uid||(t._uid=S++)}function w(t){var e=++P+"";return t?t+e:e}function k(){return k}var x=({}.toString,Array.prototype.concat,Array.prototype.indexOf,Array.prototype.slice,Array.prototype.filter,u.mixin),C=u.safeMixin,E=f.isFunction,S=1,P=0;return x(k,{createEvent:m,funcArg:v,getQueryParams:y,toPixel:g,uid:b,uniqueId:w,URL:"undefined"!=typeof window?window.URL||window.webkitURL:null}),x(k,e,n,a,u,d,f,{ArrayStore:i,async:r,Deferred:o,Evented:s,klass:l,Restful:c,Stateful:h,Xhr:p}),t.langx=k}),define("skylark-utils-dom/skylark",["skylark-langx/skylark"],function(t){return t}),define("skylark-utils-dom/langx",["skylark-langx/langx"],function(t){return t}),define("skylark-utils-dom/browser",["./skylark","./langx"],function(t,e){function i(t){return c?c+t:t.toLowerCase()}function n(t){return d[t]||t}function r(t){return h[t]||t}function o(){return o}var s,a,l="",u="",c="",h={},d={},f=/^(Webkit|webkit|O|Moz|moz|ms)(.*)$/,p=window.document,m=p.createElement("div"),v=m.webkitMatchesSelector||m.mozMatchesSelector||m.oMatchesSelector||m.matchesSelector,y=m.requestFullscreen||m.webkitRequestFullscreen||m.mozRequestFullScreen||m.msRequestFullscreen,g=(p.exitFullscreen||p.webkitCancelFullScreen||p.mozCancelFullScreen||p.msExitFullscreen,m.style);for(var b in g){var w=b.match(a||f);if(w){a||(s=w[1],a=new RegExp("^("+s+")(.*)$"),u=s,l="-"+s.toLowerCase()+"-",c=s.toLowerCase()),h[e.lowerFirst(w[2])]=b;var k=e.dasherize(w[2]);d[k]=l+k}}return e.mixin(o,{css3PropPrefix:l,isIE:!!/msie/i.exec(window.navigator.userAgent),normalizeStyleProperty:r,normalizeCssProperty:n,normalizeCssEvent:i,matchesSelector:v,requestFullScreen:y,exitFullscreen:y,location:function(){return window.location},support:{}}),m=null,t.browser=o}),define("skylark-utils-dom/styler",["./skylark","./langx"],function(t,e){function i(t,e){return"number"!=typeof e||g[y(t)]?e:e+"px"}function n(t){return t in b?b[t]:b[t]=new RegExp("(^|\\s)"+t+"(\\s|$)")}function r(t,e){var i=t.className||"",n=i&&void 0!==i.baseVal;return void 0===e?n?i.baseVal:i:void(n?i.baseVal=e:t.className=e)}function o(t,e){return arguments.length<2?!!this.dom.disabled:(t.disabled=e,this)}function s(t){var e,i;return w[t]||(e=document.createElement(t),document.body.appendChild(e),i=getComputedStyle(e,"").getPropertyValue("display"),e.parentNode.removeChild(e),"none"==i&&(i="block"),w[t]=i),w[t]}function a(t){return k.css(t,"display",""),"none"==k.css(t,"display")&&k.css(t,"display",s(t.nodeName)),this}function l(t){return"none"==k.css(t,"display")||0==k.css(t,"opacity")}function u(t){return k.css(t,"display","none"),this}function c(t,i){if(!i)return this;var o,s=r(t);return o=e.isString(i)?i.split(/\s+/g):i,o.forEach(function(t){var e=n(t);s.match(e)||(s+=(s?" ":"")+t)}),r(t,s),this}function h(t,n,r){if(arguments.length<3){var o,o=getComputedStyle(t,"");if(e.isString(n))return t.style[v(n)]||o.getPropertyValue(y(n));if(e.isArrayLike(n)){var s={};return m.call(n,function(e){s[e]=t.style[v(e)]||o.getPropertyValue(y(e))}),s}}var a="";if("string"==typeof n)r||0===r?a=y(n)+":"+i(n,r):t.style.removeProperty(y(n));else for(key in n)void 0!==n[key]&&(n[key]||0===n[key]?a+=y(key)+":"+i(key,n[key])+";":t.style.removeProperty(y(key)));return t.style.cssText+=";"+a,this}function d(t,e){var i=n(e);return t.className&&t.className.match(i)}function f(t,i){if(i){var o,s=r(t);o=e.isString(i)?i.split(/\s+/g):i,o.forEach(function(t){var e=n(t);s.match(e)&&(s=s.replace(e," "))}),r(t,s.trim())}else r(t,"");return this}function p(t,e,i){var n=this;return e.split(/\s+/g).forEach(function(e){void 0===i&&(i=!n.hasClass(t,e)),i?n.addClass(t,e):n.removeClass(t,e)}),n}var m=(Array.prototype.every,Array.prototype.forEach),v=e.camelCase,y=e.dasherize,g={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},b={},w={},k=function(){return k};return e.mixin(k,{autocssfix:!1,cssHooks:{},addClass:c,className:r,css:h,disabled:o,hasClass:d,hide:u,isInvisible:l,removeClass:f,show:a,toggleClass:p}),t.styler=k}),define("skylark-utils-dom/noder",["./skylark","./langx","./browser","./styler"],function(t,e,i,n){function r(t,i){return e.isArrayLike(t)||(t=[t]),i&&(t=H.call(t,function(t){return t.cloneNode(!0)})),e.flatten(t)}function o(t,e){var i=t.nodeName&&t.nodeName.toLowerCase();return void 0!==e?i===e.toLowerCase():i}function s(t,e,i){var n=t,o=n.parentNode;if(o)for(var s=r(e,i),n=n.nextSibling,a=0;a<s.length;a++)n?o.insertBefore(s[a],n):o.appendChild(s[a]);return this}function a(t,e,i){for(var n=t,o=r(e,i),s=0;s<o.length;s++)n.appendChild(o[s]);
return this}function l(t,e,i){var n=t,o=n.parentNode;if(o)for(var s=r(e,i),a=0;a<s.length;a++)o.insertBefore(s[a],n);return this}function u(t){return o(t,"iframe")?t.contentDocument:t.childNodes}function c(t,e,i){var n=document.createElement(t);if(e)for(var r in e)n.setAttribute(r,e[r]);return i&&a(i,n),n}function h(t){if(t=e.trim(t),z.test(t))return[c(RegExp.$1)];var i=L.test(t)&&RegExp.$1;i in B||(i="*");var n=B[i];return n.innerHTML=""+t,dom=U.call(n.childNodes),dom.forEach(function(t){n.removeChild(t)}),dom}function d(t,e){var i,n=this;return!R||1!==t.nodeType||e?t.cloneNode(e):e?void 0:(i=document.createElement(t.nodeName),each(n.getAttribs(t),function(e){n.setAttrib(i,e.nodeName,n.getAttrib(t,e.nodeName))}),i)}function f(t,e){return b(e,t)}function p(t){return document.createTextNode(t)}function m(){return document}function v(t){for(;t.hasChildNodes();){var e=t.firstChild;t.removeChild(e)}return this}function y(t){if(t===!1)i.exitFullScreen.apply(document);else{if(!t)return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement;i.requestFullScreen.apply(t),X=t}}function g(t,i){if(void 0===i)return t.innerHTML;if(this.empty(t),i=i||"",e.isString(i)&&(i=i.replace(Y,"<$1></$2>")),e.isString(i)||e.isNumber(i))t.innerHTML=i;else if(e.isArrayLike(i))for(var n=0;n<i.length;n++)t.appendChild(i[n]);else t.appendChild(i)}function b(t,e,i){if(i)return t.parentNode===e;if(document.documentElement.contains)return e.contains(t);for(;t;){if(e===t)return!0;t=t.parentNode}return!1}function w(t){return null!=t&&t.nodeType==t.DOCUMENT_NODE}function k(t){return t?9==t.nodeType?t:t.ownerDocument:document}function x(t){var e=k(t);return e.defaultView||e.parentWindow}function C(t,e,i){for(var n=t,o=n.firstChild,s=r(e,i),a=0;a<s.length;a++)o?n.insertBefore(s[a],o):n.appendChild(s[a]);return this}function E(t){for(var e=t.offsetParent||document.body;e&&!M.test(e.nodeName)&&"static"==n.css(e,"position");)e=e.offsetParent;return e}function S(t,e){var i=c("div",e);return n.css(i,{position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:2147483647,opacity:.7}),t.appendChild(i),i}function P(t){if(t&&t.parentNode)try{t.parentNode.removeChild(t)}catch(e){console.warn("The node is already removed",e)}return this}function T(t,i){e.isArrayLike(i)||(i=[i]);for(var n=0;n<i.length;n++)t.removeChild(i[n]);return this}function A(t,e){return e.parentNode.replaceChild(t,e),this}function _(t,e){e=e||{};var i,n=this,r=e.text,o=e.style,s=e.time,a=e.callback,l=this.createElement("div",{className:e.className||"throbber",style:o}),u=(S(l,{className:"overlay fade"}),this.createElement("div",{className:"throb"})),c=this.createTextNode(r||""),h=function(){i&&(clearTimeout(i),i=null),l&&(n.remove(l),l=null)},d=function(t){t&&t.text&&l&&(c.nodeValue=t.text)};u.appendChild(c),l.appendChild(u),t.appendChild(l);var f=function(){h(),a&&a()};return s&&(i=setTimeout(f,s)),{remove:h,update:d}}function O(t,e){e(t);for(var i=0,n=t.childNodes.length;i<n;i++)O(t.childNodes[i],e);return this}function N(t){for(var e=t.firstChild,i=t.children.length-1;i>0;i--)if(i>0){var n=t.children[i];t.insertBefore(n,e)}}function I(t,i){e.isString(i)&&(i=this.createFragment(i).firstChild),t.parentNode.insertBefore(i,t),i.appendChild(t)}function D(t,e){var i=U.call(t.childNodes);t.appendChild(e);for(var n=0;n<i.length;n++)e.appendChild(i[n]);return this}function j(t){var e=t.parentNode;if(e){if(this.isDoc(e.parentNode))return;e.parentNode.insertBefore(t,e)}}function F(){return F}var R=!!navigator.userAgent.match(/Trident/g)||!!navigator.userAgent.match(/MSIE/g),L=/^\s*<(\w+|!)[^>]*>/,z=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,q=document.createElement("div"),W=document.createElement("table"),$=document.createElement("tbody"),V=document.createElement("tr"),B={tr:$,tbody:W,thead:W,tfoot:W,td:V,th:V,"*":q},M=/^(?:body|html)$/i,H=Array.prototype.map,U=Array.prototype.slice,X=null,Y=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi;return e.mixin(F,{body:function(){return document.body},clone:d,contents:u,createElement:c,createFragment:h,contains:f,createTextNode:p,doc:m,empty:v,fullScreen:y,html:g,isChildOf:b,isDoc:w,isWindow:e.isWindow,offsetParent:E,ownerDoc:k,ownerWindow:x,after:s,before:l,prepend:C,append:a,remove:P,removeChild:T,replace:A,throb:_,traverse:O,reverse:N,wrapper:I,wrapperInner:D,unwrap:j}),t.noder=F}),define("skylark-utils/noder",["skylark-utils-dom/noder"],function(t){return t}),define("skylark-utils/skylark",["skylark-langx/skylark"],function(t){return t}),define("skylark-utils/langx",["skylark-langx/langx"],function(t){return t}),define("skylark-utils-dom/finder",["./skylark","./langx","./browser","./noder"],function(t,e,n,r,o){function s(t){return function(e){var i=e.nodeName.toLowerCase();return"input"===i&&e.type===t}}function a(t){return function(e){var i=e.nodeName.toLowerCase();return("input"===i||"button"===i)&&e.type===t}}function l(t,i,n){for(var r=n&&e.isString(n);t=t.parentNode;){if(b(t,i))return t;if(n)if(r){if(b(t,n))break}else if(t==n)break}return null}function u(t,i,n){for(var r=[],o=n&&e.isString(n);(t=t.parentNode)&&9!==t.nodeType;)if(r.push(t),n)if(o){if(b(t,n))break}else if(t==n)break;return i&&(r=P.filter(r,i)),r}function c(t,e){return e=e||r.doc(),e.getElementById(t)}function h(t,e){for(var i=t.childNodes,n=[],r=0;r<i.length;r++){var t=i[r];1==t.nodeType&&n.push(t)}return e&&(n=P.filter(n,e)),n}function d(t,e){for(;t&&!b(t,e);)t=t.parentNode;return t}function f(t,e){try{return A.call(t.querySelectorAll(e))}catch(i){}return P.query(t,e)}function p(t,e){try{return t.querySelector(e)}catch(i){}var n=P.query(t,e);return n.length>0?n[0]:null}function m(t,e){return e||(e=t,t=document.body),b(t,e)?t:p(t,e)}function v(t,e){return e||(e=t,t=document.body),f(t,e)}function y(t,e,i){for(var n=t.childNodes,r=n[0];r;){if(1==r.nodeType){if(!e||b(r,e))return r;if(i)break}r=r.nextSibling}return null}function g(t,e,i){for(var n=t.childNodes,r=n[n.length-1];r;){if(1==r.nodeType){if(!e||b(r,e))return r;if(i)break}r=r.previousSibling}return null}function b(t,i){if(!i||!t||1!==t.nodeType)return!1;if(e.isString(i)){try{return _.call(t,i.replace(/\[([^=]+)=\s*([^'"\]]+?)\s*\]/g,'[$1="$2"]'))}catch(n){}return P.match(t,i)}return e.isArrayLike(i)?e.inArray(t,i)>-1:e.isPlainObject(i)?P.check(t,i):t===i}function w(t,e,i){for(var n=t.nextSibling;n;){if(1==n.nodeType){if(!e||b(n,e))return n;if(i)break}n=n.nextSibling}return null}function k(t,e){for(var i=t.nextSibling,n=[];i;)1==i.nodeType&&(e&&!b(i,e)||n.push(i)),i=i.nextSibling;return n}function x(t,e){var i=t.parentNode;return!i||e&&!b(i,e)?null:i}function C(t,e,i){for(var n=t.previousSibling;n;){if(1==n.nodeType){if(!e||b(n,e))return n;if(i)break}n=n.previousSibling}return null}function E(t,e){for(var i=t.previousSibling,n=[];i;)1==i.nodeType&&(e&&!b(i,e)||n.push(i)),i=i.previousSibling;return n}function S(t,e){for(var i=t.parentNode.firstChild,n=[];i;)1==i.nodeType&&i!==t&&(e&&!b(i,e)||n.push(i)),i=i.nextSibling;return n}var P={},T=Array.prototype.filter,A=Array.prototype.slice,_=n.matchesSelector;(function(){function t(t,o,s,l,c,d,f,p,m,v,y,g,b,w,k,x){if((o||i===-1)&&(e.expressions[++i]=[],n=-1,o))return"";if(s||l||n===-1){s=s||" ";var C=e.expressions[i];r&&C[n]&&(C[n].reverseCombinator=u(s)),C[++n]={combinator:s,tag:"*"}}var E=e.expressions[i][n];if(c)E.tag=c.replace(a,"");else if(d)E.id=d.replace(a,"");else if(f)f=f.replace(a,""),E.classList||(E.classList=[]),E.classes||(E.classes=[]),E.classList.push(f),E.classes.push({value:f,regexp:new RegExp("(^|\\s)"+h(f)+"(\\s|$)")});else if(b)x=x||k,x=x?x.replace(a,""):null,E.pseudos||(E.pseudos=[]),E.pseudos.push({key:b.replace(a,""),value:x,type:1==g.length?"class":"element"});else if(p){p=p.replace(a,""),y=(y||"").replace(a,"");var S,P;switch(m){case"^=":P=new RegExp("^"+h(y));break;case"$=":P=new RegExp(h(y)+"$");break;case"~=":P=new RegExp("(^|\\s)"+h(y)+"(\\s|$)");break;case"|=":P=new RegExp("^"+h(y)+"(-|$)");break;case"=":S=function(t){return y==t};break;case"*=":S=function(t){return t&&t.indexOf(y)>-1};break;case"!=":S=function(t){return y!=t};break;default:S=function(t){return!!t}}""==y&&/^[*$^]=$/.test(m)&&(S=function(){return!1}),S||(S=function(t){return t&&P.test(t)}),E.attributes||(E.attributes=[]),E.attributes.push({key:p,operator:m,value:y,test:S})}return""}var e,i,n,r,o={},s={},a=/\\/g,l=function(n,a){if(null==n)return null;if(n.Slick===!0)return n;n=(""+n).replace(/^\s+|\s+$/g,""),r=!!a;var u=r?s:o;if(u[n])return u[n];for(e={Slick:!0,expressions:[],raw:n,reverse:function(){return l(this.raw,!0)}},i=-1;n!=(n=n.replace(d,t)););return e.length=e.expressions.length,u[e.raw]=r?c(e):e},u=function(t){return"!"===t?" ":" "===t?"!":/^!/.test(t)?t.replace(/^!/,""):"!"+t},c=function(t){for(var e=t.expressions,i=0;i<e.length;i++){for(var n=e[i],r={parts:[],tag:"*",combinator:u(n[0].combinator)},o=0;o<n.length;o++){var s=n[o];s.reverseCombinator||(s.reverseCombinator=" "),s.combinator=s.reverseCombinator,delete s.reverseCombinator}n.reverse().push(r)}return t},h=function(){var t=/(?=[\-\[\]{}()*+?.\\\^$|,#\s])/g,e="\\";return function(i){return i.replace(t,e)}}(),d=new RegExp("^(?:\\s*(,)\\s*|\\s*(<combinator>+)\\s*|(\\s+)|(<unicode>+|\\*)|\\#(<unicode>+)|\\.(<unicode>+)|\\[\\s*(<unicode1>+)(?:\\s*([*^$!~|]?=)(?:\\s*(?:([\"']?)(.*?)\\9)))?\\s*\\](?!\\])|(:+)(<unicode>+)(?:\\((?:(?:([\"'])([^\\13]*)\\13)|((?:\\([^)]+\\)|[^()]*)+))\\))?)".replace(/<combinator>/,"["+h(">+~`!@$%^&={}\\;</")+"]").replace(/<unicode>/g,"(?:[\\w\\u00a1-\\uFFFF-]|\\\\[^\\s0-9a-f])").replace(/<unicode1>/g,"(?:[:\\w\\u00a1-\\uFFFF-]|\\\\[^\\s0-9a-f])")),f=this.Slick||{};f.parse=function(t){return l(t)},f.escapeRegExp=h,this.Slick||(this.Slick=f)}).apply(P);var O=/^(?:input|select|textarea|button)$/i,N=/^h\d$/i,A=Array.prototype.slice;P.parseSelector=P.Slick.parse;var I=P.pseudos={button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},checked:function(t){return!!t.checked},contains:function(t,e,i,n){if($(this).text().indexOf(n)>-1)return this},disabled:function(t){return!!t.disabled},enabled:function(t){return!t.disabled},eq:function(t,e,i,n){return e==n},even:function(t,e,i,n){return e%2===0},focus:function(t){return document.activeElement===t&&(t.href||t.type||t.tabindex)},first:function(t,e){return 0===e},gt:function(t,e,i,n){return e>n},has:function(t,e,i,n){return m(t,n)},header:function(t){return N.test(t.nodeName)},hidden:function(t){return!P.pseudos.visible(t)},input:function(t){return O.test(t.nodeName)},last:function(t,e,i){return e===i.length-1},lt:function(t,e,i,n){return e<n},not:function(t,e,i,n){return!b(t,n)},odd:function(t,e,i,n){return e%2===1},parent:function(t){return!!t.parentNode},selected:function(t){return!!t.selected},text:function(t){return"text"===t.type},visible:function(t){return t.offsetWidth&&t.offsetWidth}};["first","eq","last"].forEach(function(t){I[t].isArrayFilter=!0}),I.nth=I.eq;for(i in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})I[i]=s(i);for(i in{submit:!0,reset:!0})I[i]=a(i);P.divide=function(t){var e,i,n,r,o,s="",a=[];if((i=t.id)&&(s+="#"+i),n=t.classes)for(var l=n.length;l--;)s+="."+n[l].value;if(r=t.attributes)for(var l=0;l<r.length;l++)s+=r[l].operator?"["+r[l].key+r[l].operator+JSON.stringify(r[l].value)+"]":"["+r[l].key+"]";if(o=t.pseudos)for(l=o.length;l--;)part=o[l],this.pseudos[part.key]?a.push(part):void 0!==part.value&&(s+=":"+part.key+"("+JSON.stringify(part));return(e=t.tag)&&"*"!==e&&(s=e.toUpperCase()+s),s||(s="*"),{nativeSelector:s,customPseudos:a}},P.check=function(t,e,i,n,r){var o,s,a,l,u,c,h,d,f;if(!r){if(o=e.tag){var p=t.nodeName.toUpperCase();if("*"==o){if(p<"@")return!1}else if(p!=(o||"").toUpperCase())return!1}if((s=e.id)&&t.getAttribute("id")!=s)return!1;if(a=e.classes)for(c=a.length;c--;)if(d=t.getAttribute("class"),!d||!a[c].regexp.test(d))return!1;if(l=e.attributes)for(c=l.length;c--;)if(h=l[c],h.operator?!h.test(t.getAttribute(h.key)):!t.hasAttribute(h.key))return!1}if(u=e.pseudos)for(c=u.length;c--;)if(h=u[c],f=this.pseudos[h.key]){if((r&&f.isArrayFilter||!r&&!f.isArrayFilter)&&!f(t,i,n,h.value))return!1}else if(!r&&!_.call(t,h.key))return!1;return!0},P.match=function(t,i){var n;if(n=e.isString(i)?P.Slick.parse(i):i,!n)return!0;var r,o,s=n.expressions,a=0;for(r=0;o=s[r];r++)if(1==o.length){var l=o[0];if(this.check(t,l))return!0;a++}if(a==n.length)return!1;var u,c=this.query(document,n);for(r=0;u=c[r++];)if(u===t)return!0;return!1},P.filterSingle=function(t,e){var i=T.call(t,function(i,n){return P.check(i,e,n,t,!1)});return i=T.call(i,function(t,n){return P.check(t,e,n,i,!0)})},P.filter=function(t,i){var n;if(!e.isString(i))return P.filterSingle(t,i);n=P.Slick.parse(i);var r,o,s=n.expressions,a=[];for(r=0;o=s[r];r++){if(1!=o.length)throw new Error("not supported selector:"+i);var l=o[0],u=P.filterSingle(t,l);a=e.uniq(a.concat(u))}return a},P.combine=function(t,e){var i,n=e.combinator,r=e,o=[];switch(n){case">":o=h(t,r);break;case"+":i=w(t,r,!0),i&&o.push(i);break;case"^":i=y(t,r,!0),i&&o.push(i);break;case"~":o=k(t,r);break;case"++":var s=C(t,r,!0),a=w(t,r,!0);s&&o.push(s),a&&o.push(a);break;case"~~":o=S(t,r);break;case"!":o=u(t,r);break;case"!>":i=x(t,r),i&&o.push(i);break;case"!+":o=C(t,r,!0);break;case"!^":i=g(t,r,!0),i&&o.push(i);break;case"!~":o=E(t,r);break;default:var l=this.divide(e);if(o=A.call(t.querySelectorAll(l.nativeSelector)),l.customPseudos)for(var c=l.customPseudos.length-1;c>=0;c--)o=T.call(o,function(t,e){return P.check(t,{pseudos:[l.customPseudos[c]]},e,o,!1)}),o=T.call(o,function(t,e){return P.check(t,{pseudos:[l.customPseudos[c]]},e,o,!0)})}return o},P.query=function(t,i,n){for(var r,o,s=this.Slick.parse(i),a=[],l=s.expressions,u=0;r=l[u];u++){for(var c,h=[t],d=0;o=r[d];d++)c=e.map(h,function(t,e){return P.combine(t,o)}),c&&(h=c);c&&(a=a.concat(c))}return a};var D=function(){return D};return e.mixin(D,{ancestor:l,ancestors:u,byId:c,children:h,closest:d,descendant:p,descendants:f,find:m,findAll:v,firstChild:y,lastChild:g,matches:b,nextSibling:w,nextSiblings:k,parent:x,previousSibling:C,previousSiblings:E,pseudos:P.pseudos,siblings:S}),t.finder=D}),define("skylark-utils-dom/datax",["./skylark","./langx","./finder"],function(t,e,i){function n(t,e,i){null==i?t.removeAttribute(e):t.setAttribute(e,i)}function r(t,e,i){return this.attr(t,"aria-"+e,i)}function o(t,e,i){if(void 0!==i)return t.setAttribute(e,i),this;if("object"==typeof e){for(var n in e)o(t,n,e[n]);return this}return t.hasAttribute&&t.hasAttribute(e)?t.getAttribute(e):void 0}function s(t){var i={};return e.each(t.attributes||[],function(t,e){0==e.name.indexOf("data-")&&(i[x(e.name.replace("data-",""))]=C(e.value))}),i}function a(t,e){var i=t._$_store;return!i&&e&&(i=t._$_store=s(t)),i}function l(t,e){if(void 0===e)return a(t,!0);var i=a(t);if(i){if(e in i)return i[e];var n=x(e);if(n in i)return i[n]}var r="data-"+e.replace(E,"-$1").toLowerCase();return o(t,r)}function u(t,e,i){var n=a(t,!0);n[x(e)]=i}function c(t,e,i){if(void 0===i){if("object"==typeof e){for(var n in e)u(t,n,e[n]);return this}return l(t,e)}return u(t,e,i),this}function h(t){t._$_store&&delete t._$_store}function d(t,i){e.isString(i)&&(i=i.split(/\s+/));var n=a(t,!0);return i.forEach(function(t){delete n[t]}),this}function f(t,e){return w.call(t,function(t){return t[e]})}function p(t,e,i){return e=S[e]||e,void 0===i?t[e]:(t[e]=i,this)}function m(t,e){return e.split(" ").forEach(function(e){n(t,e)}),this}function v(t,e){return e.split(" ").forEach(function(e){delete t[e]}),this}function y(t,e){return void 0===e?t.textContent:(t.textContent=null==e?"":""+e,this)}function g(t,e){if(void 0===e){if(t.multiple){var n=k.call(i.find(t,"option"),function(t){return t.selected});return f(n,"value")}return t.value}return t.value=e,this}function b(){return b}var w=Array.prototype.map,k=Array.prototype.filter,x=e.camelCase,C=e.deserializeValue,E=/([A-Z])/g,S={tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"};return e.mixin(b,{aria:r,attr:o,cleanData:h,data:c,pluck:f,prop:p,removeAttr:m,removeData:d,removeProp:v,text:y,val:g}),t.datax=b}),define("skylark-utils/datax",["skylark-utils-dom/datax"],function(t){return t}),define("skylark-utils/styler",["./skylark","./langx"],function(t,e){function i(t,e){return"number"!=typeof e||g[y(t)]?e:e+"px"}function n(t){return t in b?b[t]:b[t]=new RegExp("(^|\\s)"+t+"(\\s|$)")}function r(t,e){var i=t.className||"",n=i&&void 0!==i.baseVal;return void 0===e?n?i.baseVal:i:void(n?i.baseVal=e:t.className=e)}function o(t,e){return arguments.length<2?!!this.dom.disabled:(t.disabled=e,this)}function s(t){var e,i;return w[t]||(e=document.createElement(t),document.body.appendChild(e),i=getComputedStyle(e,"").getPropertyValue("display"),e.parentNode.removeChild(e),"none"==i&&(i="block"),w[t]=i),w[t]}function a(t){return k.css(t,"display",""),"none"==k.css(t,"display")&&k.css(t,"display",s(t.nodeName)),this}function l(t){return"none"==k.css(t,"display")||0==k.css(t,"opacity")}function u(t){return k.css(t,"display","none"),this}function c(t,i){if(!i)return this;var o,s=r(t);return o=e.isString(i)?i.split(/\s+/g):i,o.forEach(function(t){var e=n(t);s.match(e)||(s+=(s?" ":"")+t)}),r(t,s),this}function h(t,n,r){if(arguments.length<3){var o,o=getComputedStyle(t,"");if(e.isString(n))return t.style[v(n)]||o.getPropertyValue(y(n));if(e.isArrayLike(n)){var s={};return m.call(n,function(e){s[e]=t.style[v(e)]||o.getPropertyValue(y(e))}),s}}var a="";if("string"==typeof n)r||0===r?a=y(n)+":"+i(n,r):t.style.removeProperty(y(n));else for(key in n)void 0!==n[key]&&(n[key]||0===n[key]?a+=y(key)+":"+i(key,n[key])+";":t.style.removeProperty(y(key)));return t.style.cssText+=";"+a,this}function d(t,e){var i=n(e);return t.className&&t.className.match(i)}function f(t,i){if(i){var o,s=r(t);o=e.isString(i)?i.split(/\s+/g):i,o.forEach(function(t){var e=n(t);s.match(e)&&(s=s.replace(e," "))}),r(t,s.trim())}else r(t,"");return this}function p(t,e,i){var n=this;return e.split(/\s+/g).forEach(function(e){void 0===i&&(i=!n.hasClass(t,e)),i?n.addClass(t,e):n.removeClass(t,e)}),n}var m=(Array.prototype.every,Array.prototype.forEach),v=e.camelCase,y=e.dasherize,g={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},b={},w={},k=function(){return k};return e.mixin(k,{autocssfix:!1,cssHooks:{},addClass:c,className:r,css:h,disabled:o,hasClass:d,hide:u,isInvisible:l,removeClass:f,show:a,toggleClass:p}),t.styler=k}),define("skylark-utils-dom/geom",["./skylark","./langx","./noder","./styler"],function(t,e,i,n){function r(){if(void 0!==A)return A;var t,e,r=i.createFragment("<div style='display:block;position:absolute;width:200px;height:200px;overflow:hidden;'><div style='height:300px;width:auto;'></div></div>")[0],o=r.childNodes[0];return i.append(document.body,r),t=o.offsetWidth,n.css(r,"overflow","scroll"),e=o.offsetWidth,t===e&&(e=r[0].clientWidth),i.remove(r),A=t-e}function o(t){var e=getComputedStyle(t);return{left:O(e.borderLeftWidth,t),top:O(e.borderTopWidth,t),right:O(e.borderRightWidth,t),bottom:O(e.borderBottomWidth,t)}}function s(t,e){if(void 0===e)return _.test(t.nodeName)?{top:0,left:0}:t.getBoundingClientRect();var i=N(t),n=s(i),r=p(t),a=o(i);return w(t,{top:e.top-n.top-r.top-a.top,left:e.left-n.left-r.left-a.left}),this}function a(t,e){return void 0===e?t.getBoundingClientRect():(s(t,e),S(t,e),this)}function l(t,e){return void 0==e?u(t).height:u(t,{height:e})}function u(t,e){if(void 0==e)return{width:t.clientWidth,height:t.clientHeight};var i="border-box"===n.css(t,"box-sizing"),r={width:e.width,height:e.height};if(i){var s=o(t);void 0!==r.width&&(r.width=r.width+s.left+s.right),void 0!==r.height&&(r.height=r.height+s.top+s.bottom)}else{var a=y(t);void 0!==r.width&&(r.width=r.width-a.left-a.right),void 0!==r.height&&(r.height=r.height-a.top-a.bottom)}return n.css(t,r),this}function c(t,e){return void 0==e?u(t).width:(u(t,{width:e}),this)}function h(t){var e=u(t),i=y(t);return{left:i.left,top:i.top,width:e.width-i.left-i.right,height:e.height-i.top-i.bottom}}function d(t){var e=t.documentElement,i=t.body,n=Math.max,r=n(e.scrollWidth,i.scrollWidth),o=n(e.clientWidth,i.clientWidth),s=n(e.offsetWidth,i.offsetWidth),a=n(e.scrollHeight,i.scrollHeight),l=n(e.clientHeight,i.clientHeight),u=n(e.offsetHeight,i.offsetHeight);return{width:r<s?o:r,height:a<u?l:a}}function f(t,e){return void 0==e?S(t).height:(S(t,{height:e}),this)}function p(t){var e=getComputedStyle(t);return{left:O(e.marginLeft),top:O(e.marginTop),right:O(e.marginRight),bottom:O(e.marginBottom)}}function m(t){var e=this.relativeRect(t),i=this.marginExtents(t);return{left:e.left,top:e.top,width:e.width+i.left+i.right,height:e.height+i.top+i.bottom}}function v(t){var e=this.size(t),i=this.marginExtents(t);return{width:e.width+i.left+i.right,height:e.height+i.top+i.bottom}}function y(t){var e=getComputedStyle(t);return{left:O(e.paddingLeft),top:O(e.paddingTop),right:O(e.paddingRight),bottom:O(e.paddingBottom)}}function g(t,e){if(void 0===e){var i=t.getBoundingClientRect();return{left:i.left+window.pageXOffset,top:i.top+window.pageYOffset}}var n=N(t),r=g(n),s=p(t),a=o(n);return w(t,{top:e.top-r.top-s.top-a.top,left:e.left-r.left-s.left-a.left}),this}function b(t,e){if(void 0===e){var i=t.getBoundingClientRect();return{left:i.left+window.pageXOffset,top:i.top+window.pageYOffset,width:Math.round(i.width),height:Math.round(i.height)}}return g(t,e),S(t,e),this}function w(t,e){if(void 0==e){var i=N(t),r=s(t),a=s(i),l=(p(t),o(i));return{top:r.top-a.top-l.top,left:r.left-a.left-l.left}}var u={top:e.top,left:e.left};return"static"==n.css(t,"position")&&(u.position="relative"),n.css(t,u),this}function k(t,e){if(void 0===e){var i=N(t),n=a(t),r=s(i),l=(p(t),o(i));return{top:n.top-r.top-l.top,left:n.left-r.left-l.left,width:n.width,height:n.height}}return w(t,e),S(t,e),this}function x(t,e){function i(t,e){var i,n,r=t;for(i=n=0;r&&r!=e&&r.nodeType;)i+=r.offsetLeft||0,n+=r.offsetTop||0,r=r.offsetParent;return{x:i,y:n}}var n,r,o,s,a,l,u=t.parentNode,c=i(t,u);return n=c.x,r=c.y,o=t.offsetWidth,s=t.offsetHeight,a=u.clientWidth,l=u.clientHeight,"end"==e?(n-=a-o,r-=l-s):"center"==e&&(n-=a/2-o/2,r-=l/2-s/2),u.scrollLeft=n,u.scrollTop=r,this}function C(t,e){var i="scrollLeft"in t;return void 0===e?i?t.scrollLeft:t.pageXOffset:(i?t.scrollLeft=e:t.scrollTo(e,t.scrollY),this)}function E(t,e){var i="scrollTop"in t;return void 0===e?i?t.scrollTop:t.pageYOffset:(i?t.scrollTop=e:t.scrollTo(t.scrollX,e),this)}function S(t,i){if(void 0==i)return e.isWindow(t)?{width:t.innerWidth,height:t.innerHeight}:e.isDocument(t)?d(document):{width:t.offsetWidth,height:t.offsetHeight};var r="border-box"===n.css(t,"box-sizing"),s={width:i.width,height:i.height};if(!r){var a=y(t),l=o(t);void 0!==s.width&&""!==s.width&&null!==s.width&&(s.width=s.width-a.left-a.right-l.left-l.right),void 0!==s.height&&""!==s.height&&null!==s.height&&(s.height=s.height-a.top-a.bottom-l.top-l.bottom)}return n.css(t,s),this}function P(t,e){return void 0==e?S(t).width:(S(t,{width:e}),this)}function T(){return T}var A,_=/^(?:body|html)$/i,O=e.toPixel,N=i.offsetParent;return e.mixin(T,{borderExtents:o,boundingPosition:s,boundingRect:a,clientHeight:l,clientSize:u,clientWidth:c,contentRect:h,getDocumentSize:d,height:f,marginExtents:p,marginRect:m,marginSize:v,offsetParent:N,paddingExtents:y,pagePosition:g,pageRect:b,relativePosition:w,relativeRect:k,scrollbarWidth:r,scrollIntoView:x,scrollLeft:C,scrollTop:E,size:S,width:P}),t.geom=T}),define("skylark-utils/geom",["skylark-utils-dom/geom"],function(t){return t}),define("skylark-utils-dom/eventer",["./skylark","./langx","./browser","./finder","./noder","./datax"],function(t,e,i,n,r,o){function s(t,i){return!i&&t.isDefaultPrevented||(i||(i=t),e.each(b,function(n,r){var o=i[n];t[n]=function(){return this[r]=e.returnTrue,o&&o.apply(i,arguments)},t[r]=e.returnFalse})),t}function a(t){var e=(""+t).split(".");return{type:e[0],ns:e.slice(1).sort().join(" ")}}function l(t,i){var n,r={originalEvent:t};for(n in t)"keyIdentifier"===n||g.test(n)||void 0===t[n]||(r[n]=t[n]);return i&&e.mixin(r,i),s(r,t)}function u(t,i,n,r){var o=this;if(e.isPlainObject(i))return e.each(i,function(e,i){u(t,e,n,i)}),o;e.isString(n)||e.isFunction(r)||r===!1||(r=n,n=void 0),r===!1&&(r=e.returnFalse),"string"==typeof i&&(i=i.indexOf(",")>-1?i.split(","):i.split(/\s/));var s=O(t);return i&&i.forEach(function(t){s.unregister(t,r,{selector:n})}),this}function c(t,i,n,r,o,s){if(e.isPlainObject(i))return e.each(i,function(e,i){c(t,e,n,r,i,s)}),this;e.isString(n)||e.isFunction(o)||(o=r,r=n,n=void 0),e.isFunction(r)&&(o=r,r=void 0),o===!1&&(o=e.returnFalse),"string"==typeof i&&(i=i.indexOf(",")>-1?i.split(","):i.split(/\s/));var a=O(t);return i.forEach(function(t){return"ready"==t?p(o):void a.register(t,o,{data:r,selector:n,one:!!s})}),this}function h(t,e,i,n,r){return c(t,e,i,n,r,1),this}function d(t){return window.document.all&&(t.keyCode=0),t.preventDefault&&(t.preventDefault(),t.stopPropagation()),this}function f(t,e,i){var n;n=e instanceof Event?e:k(e,i),n._args=i;var r=t.dispatchEvent||t.trigger;return r?r.call(t,n):console.warn("The evented parameter is not a eventable object"),this}function p(t){return w.test(document.readyState)&&document.body?e.defer(t):document.addEventListener("DOMContentLoaded",t,!1),this}function m(t){var e=o.data(t,"shortcuts");if(!e){e={},o.data(t,"shortcuts",e);var i=function(t,e){var i=e.metaKey||e.ctrlKey;if(t.ctrl==i&&t.alt==e.altKey&&t.shift==e.shiftKey&&(e.keyCode==t.keyCode||e.charCode&&e.charCode==t.charCode))return e.preventDefault(),"keydown"==e.type&&t.fn(e),!0};c(t,"keyup keypress keydown",function(t){if(!/INPUT|TEXTAREA/.test(t.target.nodeName))for(var n in e)i(e[n],t)})}return{add:function(t,i){var n;n=t.indexOf(",")>-1?t.toLowerCase().split(","):t.toLowerCase().split(" "),n.forEach(function(t){var n={fn:i,alt:!1,ctrl:!1,shift:!1};t.split("+").forEach(function(t){switch(t){case"alt":case"ctrl":case"shift":n[t]=!0;break;default:n.charCode=t.charCodeAt(0),n.keyCode=N[t]||t.toUpperCase().charCodeAt(0)}});var r=(n.ctrl?"ctrl":"")+","+(n.alt?"alt":"")+","+(n.shift?"shift":"")+","+n.keyCode;e[r]=n})}}}function v(){return v}var y=(e.mixin,e.each,Array.prototype.slice,e.uid),g=/^([A-Z]|returnValue$|layer[XY]$)/,b={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"},w=/complete|loaded|interactive/,k=function(){function t(t){var e=n[t];return e||(e=0),i[e]}var i=[window.CustomEvent,window.CompositionEvent,window.DragEvent,window.Event,window.FocusEvent,window.KeyboardEvent,window.MessageEvent,window.MouseEvent,window.MouseScrollEvent,window.MouseWheelEvent,window.MutationEvent,window.ProgressEvent,window.TextEvent,window.TouchEvent,window.UIEvent,window.WheelEvent,window.ClipboardEvent],n={compositionstart:1,compositionend:1,compositionupdate:1,beforecopy:16,beforecut:16,beforepaste:16,copy:16,cut:16,paste:16,drag:2,dragend:2,dragenter:2,dragexit:2,dragleave:2,dragover:2,dragstart:2,drop:2,abort:3,change:3,error:3,selectionchange:3,submit:3,reset:3,focus:4,blur:4,focusin:4,focusout:4,keydown:5,keypress:5,keyup:5,message:6,click:7,contextmenu:7,dblclick:7,mousedown:7,mouseup:7,mousemove:7,mouseover:7,mouseout:7,mouseenter:7,mouseleave:7,textInput:12,touchstart:13,touchmove:13,touchend:13,load:14,resize:14,select:14,scroll:14,unload:14,wheel:15};return function(i,n){e.isString(i)?n=n||{}:(n=i||{},i=n.type||"");var r=a(i);i=r.type,n=e.mixin({bubbles:!0,cancelable:!0},n),r.ns&&(n.namespace=r.ns);var o=t(i),l=new o(i,n);return e.safeMixin(l,n),s(l)}}(),x={},C="onfocusin"in window,E={focus:"focusin",blur:"focusout"},S={mouseenter:"mouseover",mouseleave:"mouseout"},P=function(t){return S[t]||C&&E[t]||t},T={},A=e.klass({init:function(t,e){this._target=t,this._event=e,this._bindings=[]},add:function(t,i){var o=this._bindings,s={fn:t,options:e.mixin({},i)};o.push(s);var a=this;if(!a._listener){a._listener=function(t){var i=this,o=l(t),s=t._args,u=a._bindings,c=o.namespace;s=e.isDefined(s)?[o].concat(s):[o],e.each(u,function(t,l){var u=i;if(o.isImmediatePropagationStopped&&o.isImmediatePropagationStopped())return!1;var h=l.fn,d=l.options||{},f=d.selector,p=d.one,m=d.data;if(!c||c==d.ns||d.ns.indexOf(c)!==-1){if(f){if(u=n.closest(o.target,f),!u||u===i)return;e.mixin(o,{currentTarget:u,liveFired:i})}var v=a._event;if(v in S){var y=o.relatedTarget;if(y&&(y===u||r.contains(u,y)))return}e.isDefined(m)&&(o.data=m),p&&a.remove(h,d);var g=h.apply(u,s);g===!1&&(o.preventDefault(),o.stopPropagation())}})};var u=a._event;a._target.addEventListener?a._target.addEventListener(P(u),a._listener,!1):console.warn("invalid eventer object",a._target)}},remove:function(t,i){function n(t){return new RegExp("(?:^| )"+t.replace(" "," .* ?")+"(?: |$)")}i=e.mixin({},i);var r;i.ns&&(r=n(i.ns)),this._bindings=this._bindings.filter(function(e){var n=(!t||t===e.fn)&&(!r||r.test(e.options.ns))&&(!i.selector||i.selector==e.options.selector);return!n}),0==this._bindings.length&&(this._target.removeEventListener&&this._target.removeEventListener(P(this._event),this._listener,!1),this._listener=null)}}),_=e.klass({init:function(t){this._target=t,this._handler={}},register:function(t,i,n){var r=a(t),t=r.type,o=x[t],s=o&&(o.bindType||o.bindEventName),l=this._handler;void 0===l[t]&&(l[t]=new A(this._target,s||t)),l[t].add(i,e.mixin({ns:r.ns},n))},unregister:function(t,i,n){var r=this._handler,o=a(t);if(t=o.type){var s=r[t];s&&s.remove(i,e.mixin({ns:o.ns},n))}else for(t in r){var s=r[t];s.remove(i,e.mixin({ns:o.ns},n))}}}),O=function(t){var e=y(t),i=T[e];return i||(i=T[e]=new _(t)),i},N={backspace:8,comma:188,"delete":46,down:40,end:35,enter:13,escape:27,home:36,left:37,page_down:34,page_up:33,period:190,right:39,space:32,tab:9,up:38};return e.mixin(v,{create:k,keys:N,off:u,on:c,one:h,proxy:l,ready:p,shortcuts:m,special:x,stop:d,trigger:f}),t.eventer=v}),define("skylark-utils/eventer",["skylark-utils-dom/eventer"],function(t){return t}),define("skylark-utils-dom/fx",["./skylark","./langx","./browser","./geom","./styler","./eventer"],function(t,e,i,n,r,o){function s(t,i,s,a,l,c){var h,d,f,p={},m=[],v="",y=this,x=!1,I=!1,D=!1;if(e.isPlainObject(s)&&(a=s.easing,l=s.complete,c=s.delay,s=s.duration),e.isString(s)&&(s=g.speeds[s]),void 0===s&&(s=g.speeds.normal),s/=1e3,g.off&&(s=0),e.isFunction(a)?(l=a,eace="swing"):a=a||"swing",c?c/=1e3:c=0,e.isString(i))p[b]=i,p[w]=s+"s",p[k]=a,d=T;else{for(h in i){var j=i[h];if(_.test(h))v+=h+"("+j+") ";else{if("scrollTop"===h&&(I=!0),"clip"==h&&e.isPlainObject(j)){if(p[h]="rect("+j.top+"px,"+j.right+"px,"+j.bottom+"px,"+j.left+"px)","auto"==r.css(t,"clip")){var F=n.size(t);r.css(t,"clip","rect(0px,"+F.width+"px,"+F.height+"px,0px)"),D=!0}}else p[h]=j;m.push(e.dasherize(h))}}d=A}return v&&(p[O]=v,m.push(O)),s>0&&e.isPlainObject(i)&&(p[C]=m.join(", "),p[E]=s+"s",p[P]=c+"s",p[S]=a),f=function(e){if(x=!0,e){if(e.target!==e.currentTarget)return;o.off(e.target,d,f)}else o.off(t,T,f);r.css(t,N),l&&l.call(this)},s>0&&(o.on(t,d,f),e.debounce(function(){x||f.call(y)},1e3*(s+c)+25)()),t.clientLeft,r.css(t,p),s<=0&&e.debounce(function(){x||f.call(y)},0)(),I&&u(t,i.scrollTop,s,l),this}function a(t,i,n){return r.show(t),i&&(!n&&e.isFunction(i)&&(n=i,i="normal"),r.css(t,"opacity",0),s(t,{opacity:1,scale:"1,1"},i,n)),this}function l(t,i,n){return i?(!n&&e.isFunction(i)&&(n=i,i="normal"),s(t,{opacity:0,scale:"0,0"},i,function(){r.hide(t),n&&n.call(t)})):r.hide(t),this}function u(t,i,n,r){var o=parseInt(t.scrollTop),s=0,a=5,l=1e3*n/a,u=parseInt(i),c=setInterval(function(){s++,s<=l&&(t.scrollTop=(u-o)/l*s+o),s>=l+1&&(clearInterval(c),r&&e.debounce(r,1e3)())},a)}function c(t,e,i){return r.isInvisible(t)?a(t,e,i):l(t,e,i),this}function h(t,e,i,n,r){return s(t,{opacity:i},e,n,r),this}function d(t,e,i,n){var o=r.css(t,"opacity");return o>0?r.css(t,"opacity",0):o=1,
r.show(t),h(t,e,o,i,n),this}function f(t,i,n,o){var s,a=r.css(t,"opacity"),l={};return e.isPlainObject(i)?(l.easing=i.easing,l.duration=i.duration,s=i.complete):(l.duration=i,o?(s=o,l.easing=n):s=n),l.complete=function(){r.css(t,"opacity",a),r.hide(t),s&&s.call(t)},h(t,l,0),this}function p(t,e,i,n){return r.isInvisible(t)?d(t,e,easing,callback):f(t,e,easing,callback),this}function m(t,e,i){var n=r.css(t,"position");a(t),r.css(t,{position:"absolute",visibility:"hidden"});var o=r.css(t,"margin-top"),l=r.css(t,"margin-bottom"),u=r.css(t,"padding-top"),c=r.css(t,"padding-bottom"),h=r.css(t,"height");return r.css(t,{position:n,visibility:"visible",overflow:"hidden",height:0,marginTop:0,marginBottom:0,paddingTop:0,paddingBottom:0}),s(t,{height:h,marginTop:o,marginBottom:l,paddingTop:u,paddingBottom:c},{duration:e,complete:function(){i&&i.apply(t)}}),this}function v(t,e,i){if(n.height(t)>0){var o=(r.css(t,"position"),r.css(t,"height")),a=r.css(t,"margin-top"),u=r.css(t,"margin-bottom"),c=r.css(t,"padding-top"),h=r.css(t,"padding-bottom");r.css(t,{visibility:"visible",overflow:"hidden",height:o,marginTop:a,marginBottom:u,paddingTop:c,paddingBottom:h}),s(t,{height:0,marginTop:0,marginBottom:0,paddingTop:0,paddingBottom:0},{duration:e,queue:!1,complete:function(){l(t),r.css(t,{visibility:"visible",overflow:"hidden",height:o,marginTop:a,marginBottom:u,paddingTop:c,paddingBottom:h}),i&&i.apply(t)}})}return this}function y(t,e,i){return 0==n.height(t)?m(t,e,i):v(t,e,i),this}function g(){return g}var b,w,k,x,C,E,S,P,T=i.normalizeCssEvent("AnimationEnd"),A=i.normalizeCssEvent("TransitionEnd"),_=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i,O=i.css3PropPrefix+"transform",N={};return N[b=i.normalizeCssProperty("animation-name")]=N[w=i.normalizeCssProperty("animation-duration")]=N[x=i.normalizeCssProperty("animation-delay")]=N[k=i.normalizeCssProperty("animation-timing-function")]="",N[C=i.normalizeCssProperty("transition-property")]=N[E=i.normalizeCssProperty("transition-duration")]=N[P=i.normalizeCssProperty("transition-delay")]=N[S=i.normalizeCssProperty("transition-timing-function")]="",e.mixin(g,{off:!1,speeds:{normal:400,fast:200,slow:600},animate:s,fadeIn:d,fadeOut:f,fadeTo:h,fadeToggle:p,hide:l,scrollToTop:u,slideDown:m,slideToggle:y,slideUp:v,show:a,toggle:c}),t.fx=g}),define("skylark-utils-dom/query",["./skylark","./langx","./noder","./datax","./eventer","./finder","./geom","./styler","./fx"],function(t,e,i,n,r,o,s,a,l){function u(t,e){return function(){var i=this,n=w.call(arguments),r=$.map(i,function(i,r){return t.apply(e,[i].concat(n))});return $(_(r))}}function c(t,e,i){return function(n){var r=(w.call(arguments),this.map(function(r,o){if(o.querySelector)return t.apply(e,i?[o]:[o,n])}));return i&&n?r.filter(n):r}}function h(t,e,i){return function(n,r){w.call(arguments);void 0===r&&(r=n,n=void 0);var o=this.map(function(o,s){if(s.querySelector)return t.apply(e,i?[s,n]:[s,r,n])});return i&&r?o.filter(r):o}}function d(t,e){return function(){var i=this,n=w.call(arguments);return this.each(function(i){t.apply(e,[this].concat(n))}),i}}function f(t,e,i){return function(n){var r=this,o=w.call(arguments);return x.call(r,function(r,s){P(r,n,s,i(r));t.apply(e,[r,n].concat(o.slice(1)))}),r}}function p(t,e){return function(){var i=this,n=w.call(arguments);return g.call(i,function(i){return t.apply(e,[i].concat(n))})}}function m(t,i,n){return function(r,o){var s=this,a=w.call(arguments);return e.isPlainObject(r)||e.isDefined(o)?(x.call(s,function(e,s){var l;l=n?P(e,o,s,n(e,r)):o,t.apply(i,[e].concat(a))}),s):s[0]?t.apply(i,[s[0],r]):void 0}}function v(t,i,n){return function(r){var o=this;return e.isDefined(r)?(x.call(o,function(e,o){var s;s=n?P(e,r,o,n(e)):r,t.apply(i,[e,s])}),o):o[0]?t.apply(i,[o[0]]):void 0}}var y,g=Array.prototype.some,b=Array.prototype.push,w=(Array.prototype.every,Array.prototype.concat,Array.prototype.slice),k=(Array.prototype.map,Array.prototype.filter),x=Array.prototype.forEach,C=Array.prototype.indexOf,E=Array.prototype.sort,S=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,P=e.funcArg,T=e.isArrayLike,A=e.isString,_=e.uniq,O=e.isFunction,N=e.type,I=e.isArray,D=(e.isWindow,e.isDocument,e.isObject),j=(e.isPlainObject,e.compact,e.flatten,e.camelCase,e.dasherize,o.children,e.klass({klassName:"SkNodeList",init:function(t,n){var r,s,a,l,u=this;if(t&&(u.context=n=n||i.doc(),A(t)?(u.selector=t,r="<"===t.charAt(0)&&">"===t.charAt(t.length-1)&&t.length>=3?[null,t,null]:S.exec(t),r?r[1]?(s=i.createFragment(t),e.isPlainObject(n)&&(l=n)):(a=o.byId(r[2],i.ownerDoc(n)),a&&(s=[a])):(e.isString(n)&&(n=o.find(n)),s=o.descendants(n,t))):s=I(t)?t:[t]),s&&(b.apply(u,s),l))for(var c in l)e.isFunction(this[c])?this[c](l[c]):this.attr(c,l[c]);return u}})),F=function(){function t(t,n,r){return function(r){var o,s=e.map(arguments,function(t){return o=N(t),"object"==o||"array"==o||null==t?t:i.createFragment(t)});return s.length<1?this:(this.each(function(e){t.apply(n,[this,s,e>0])}),this)}}y=function(t){return t instanceof j},init=function(t,e){return new j(t,e)};var S=function(t,e){return O(t)?void r.ready(function(){t(S)}):y(t)?t:e&&y(e)&&A(t)?e.find(t):init(t,e)};S.fn=j.prototype,e.mixin(S.fn,{length:0,map:function(t){return S(_(e.map(this,function(e,i){return t.call(e,i,e)})))},slice:function(){return S(w.apply(this,arguments))},forEach:function(){return x.apply(this,arguments)},get:function(t){return void 0===t?w.call(this):this[t>=0?t:t+this.length]},indexOf:function(){return C.apply(this,arguments)},sort:function(){return E.apply(this,arguments)},toArray:function(){return w.call(this)},size:function(){return this.length},remove:d(i.remove,i),each:function(t){return e.each(this,t),this},filter:function(t){return O(t)?this.not(this.not(t)):S(k.call(this,function(e){return o.matches(e,t)}))},add:function(t,e){return S(_(this.toArray().concat(S(t,e).toArray())))},is:function(t){if(this.length>0){var i=this;if(e.isString(t))return g.call(i,function(e){return o.matches(e,t)});if(e.isArrayLike(t))return g.call(i,function(i){return e.inArray(i,t)>-1});if(e.isHtmlNode(t))return g.call(i,function(e){return e==t})}return!1},not:function(t){var e=[];if(O(t)&&void 0!==t.call)this.each(function(i){t.call(this,i)||e.push(this)});else{var i="string"==typeof t?this.filter(t):T(t)&&O(t.item)?w.call(t):S(t);this.forEach(function(t){i.indexOf(t)<0&&e.push(t)})}return S(e)},has:function(t){return this.filter(function(){return D(t)?i.contains(this,t):S(this).find(t).size()})},eq:function(t){return t===-1?this.slice(t):this.slice(t,+t+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},find:c(o.descendants,o),closest:c(o.closest,o),parents:c(o.ancestors,o),parentsUntil:h(o.ancestors,o),parent:c(o.parent,o),children:c(o.children,o),contents:u(i.contents,i),empty:d(i.empty,i),pluck:function(t){return e.map(this,function(e){return e[t]})},pushStack:function(t){var e=S(t);return e.prevObject=this,e},show:d(l.show,l),replaceWith:function(t){return this.before(t).remove()},wrap:function(t){var e=O(t);if(this[0]&&!e)var i=S(t).get(0),n=i.parentNode||this.length>1;return this.each(function(r){S(this).wrapAll(e?t.call(this,r):n?i.cloneNode(!0):i)})},wrapAll:function(t){if(this[0]){S(this[0]).before(t=S(t));for(var e;(e=t.children()).length;)t=e.first();S(t).append(this)}return this},wrapInner:function(t){var e=O(t);return this.each(function(i){var n=S(this),r=n.contents(),o=e?t.call(this,i):t;r.length?r.wrapAll(o):n.append(o)})},unwrap:function(t){return 0===this.parent().children().length?this.parent(t).not("body").each(function(){S(this).replaceWith(document.createTextNode(this.childNodes[0].textContent))}):this.parent().each(function(){S(this).replaceWith(S(this).children())}),this},clone:function(){return this.map(function(){return this.cloneNode(!0)})},hide:d(l.hide,l),toggle:function(t){return this.each(function(){var e=S(this);(void 0===t?"none"==e.css("display"):t)?e.show():e.hide()})},prev:function(t){return S(this.pluck("previousElementSibling")).filter(t||"*")},prevAll:c(o.previousSibling,o),next:function(t){return S(this.pluck("nextElementSibling")).filter(t||"*")},nextAll:c(o.nextSiblings,o),siblings:c(o.siblings,o),html:v(i.html,i,i.html),text:v(n.text,n,n.text),attr:m(n.attr,n,n.attr),removeAttr:d(n.removeAttr,n),prop:m(n.prop,n,n.prop),removeProp:d(n.removeProp,n),data:m(n.data,n,n.data),removeData:d(n.removeData,n),val:v(n.val,n,n.val),offset:v(s.pagePosition,s,s.pagePosition),style:m(a.css,a),css:m(a.css,a),index:function(t){return t?this.indexOf(S(t)[0]):this.parent().children().indexOf(this[0])},hasClass:p(a.hasClass,a),addClass:f(a.addClass,a,a.className),removeClass:f(a.removeClass,a,a.className),toggleClass:f(a.toggleClass,a,a.className),scrollTop:v(s.scrollTop,s),scrollLeft:v(s.scrollLeft,s),position:function(){if(this.length){var t=this[0];return s.relativePosition(t)}},offsetParent:u(s.offsetParent,s)}),S.fn.detach=S.fn.remove,S.fn.hover=function(t,e){return this.mouseenter(t).mouseleave(e||t)},S.fn.size=v(s.size,s),S.fn.width=v(s.width,s,s.width),S.fn.height=v(s.height,s,s.height),S.fn.clientSize=v(s.clientSize,s.clientSize),["width","height"].forEach(function(t){var e=t.replace(/./,function(t){return t[0].toUpperCase()});S.fn["outer"+e]=function(e,i){if(arguments.length?"boolean"!=typeof e&&(i=e,e=!1):(e=!1,i=void 0),void 0===i){var n=this[0];if(!n)return;var r=s.size(n);if(e){var o=s.marginExtents(n);r.width=r.width+o.left+o.right,r.height=r.height+o.top+o.bottom}return"width"===t?r.width:r.height}return this.each(function(n,r){var o={},a=s.marginExtents(r);"width"===t?(o.width=i,e&&(o.width=o.width-a.left-a.right)):(o.height=i,e&&(o.height=o.height-a.top-a.bottom)),s.size(r,o)})}}),S.fn.innerWidth=v(s.clientWidth,s,s.clientWidth),S.fn.innerHeight=v(s.clientHeight,s,s.clientHeight);i.traverse;return S.fn.after=t(i.after,i),S.fn.prepend=t(i.prepend,i),S.fn.before=t(i.before,i),S.fn.append=t(i.append,i),e.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,e){S.fn[t]=function(t){for(var i,n=[],r=S(t),o=r.length-1,s=0;s<=o;s++)i=s===o?this:this.clone(!0),S(r[s])[e](i),b.apply(n,i.get());return this.pushStack(n)}}),S}();return function(t){t.fn.on=d(r.on,r),t.fn.off=d(r.off,r),t.fn.trigger=d(r.trigger,r),"focusin focusout focus blur load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach(function(e){t.fn[e]=function(t,i){return 0 in arguments?this.on(e,t,i):this.trigger(e)}}),t.fn.one=function(t,i,n,r){return e.isString(i)||e.isFunction(r)||(r=n,n=i,i=null),e.isFunction(n)&&(r=n,n=null),this.on(t,i,n,r,1)},t.fn.animate=d(l.animate,l),t.fn.show=d(l.show,l),t.fn.hide=d(l.hide,l),t.fn.toogle=d(l.toogle,l),t.fn.fadeTo=d(l.fadeTo,l),t.fn.fadeIn=d(l.fadeIn,l),t.fn.fadeOut=d(l.fadeOut,l),t.fn.fadeToggle=d(l.fadeToggle,l),t.fn.slideDown=d(l.slideDown,l),t.fn.slideToggle=d(l.slideToggle,l),t.fn.slideUp=d(l.slideUp,l)}(F),function(t){t.fn.end=function(){return this.prevObject||t()},t.fn.andSelf=function(){return this.add(this.prevObject||t())},t.fn.addBack=function(t){return this.prevObject?t?this.add(this.prevObject.filter(t)):this.add(this.prevObject):this},"filter,add,not,eq,first,last,find,closest,parents,parent,children,siblings".split(",").forEach(function(e){var i=t.fn[e];t.fn[e]=function(){var t=i.apply(this,arguments);return t.prevObject=this,t}})}(F),function(t){t.fn.query=t.fn.find,t.fn.place=function(t,n){return e.isString(t)?t=o.descendant(t):y(t)&&(t=t[0]),this.each(function(e,r){switch(n){case"before":i.before(t,r);break;case"after":i.after(t,r);break;case"replace":i.replace(t,r);break;case"only":i.empty(t),i.append(t,r);break;case"first":i.prepend(t,r);break;default:i.append(t,r)}})},t.fn.addContent=function(t,i){return t.template&&(t=e.substitute(t.template,t)),this.append(t)},t.fn.replaceClass=function(t,e){return this.removeClass(e),this.addClass(t),this}}(F),t.query=F}),define("skylark-utils/query",["skylark-utils-dom/query"],function(t){return t}),define("skylark-utils-dom/velm",["./skylark","./langx","./datax","./eventer","./finder","./fx","./geom","./noder","./styler"],function(t,e,i,n,r,o,s,a,l){function u(t,i){return function(){var n=this,r=n.domNode,o=t.apply(i,[r].concat(h.call(arguments)));if(o){if(o===i)return n;o instanceof HTMLElement?o=new d(o):e.isArrayLike(o)&&(o=c.call(o,function(t){return t instanceof HTMLElement?new d(o):t}))}return o}}var c=Array.prototype.map,h=Array.prototype.slice,d=e.klass({klassName:"VisualElement",init:function(t){e.isString(t)&&(t=document.getElementById(t)),this.domNode=t}}),f=new d(document.body),p=function(t){return t?new d(t):f};e.mixin(p,{batch:function(t,e,i){return t.forEach(function(t){var n=t instanceof d?t:p(t);n[e].apply(n,i)}),this},root:new d(document.body),VisualElement:d,partial:function(t,e){var i={};i[t]=e,d.partial(i)},delegate:function(t,e){var i={};t.forEach(function(t){i[t]=u(e[t],e)}),d.partial(i)}}),p.delegate(["attr","data","prop","removeAttr","removeData","text","val"],i),p.delegate(["draggable","droppable"],dnd),p.delegate(["off","on","one","shortcuts","trigger"],n),p.delegate(["ancestor","ancestors","children","descendant","find","findAll","firstChild","lastChild","matches","nextSibling","nextSiblings","parent","previousSibling","previousSiblings","siblings"],r),p.find=function(t){return"body"===t?this.root:this.root.descendant(t)},p.delegate(["animate","fadeIn","fadeOut","fadeTo","fadeToggle","hide","scrollToTop","show","toggle"],o),p.delegate(["borderExtents","boundingPosition","boundingRect","clientHeight","clientSize","clientWidth","contentRect","height","marginExtents","offsetParent","paddingExtents","pagePosition","pageRect","relativePosition","relativeRect","scrollIntoView","scrollLeft","scrollTop","size","width"],s),p.delegate(["after","append","before","clone","contains","contents","empty","html","isChildOf","ownerDoc","prepend","remove","removeChild","replace","reverse","throb","traverse","wrapper","wrapperInner","unwrap"],a),p.delegate(["addClass","className","css","hasClass","hide","isInvisible","removeClass","show","toggleClass"],l);var m=["position","left","top","right","bottom","width","height","border","borderLeft","borderTop","borderRight","borderBottom","borderColor","display","overflow","margin","marginLeft","marginTop","marginRight","marginBottom","padding","paddingLeft","paddingTop","paddingRight","paddingBottom","color","background","backgroundColor","opacity","fontSize","fontWeight","textAlign","textDecoration","textTransform","cursor","zIndex"];m.forEach(function(t){var e=t;d.prototype[e]=function(e){return this.css(t,e),this}});var v=["keyUp","keyDown","mouseOver","mouseOut","click","dblClick","change"];return v.forEach(function(t){var e=t;d.prototype[e]=function(e){return this.on(t.toLowerCase(),e),this}}),t.velm=p}),define("skylark-utils/velm",["skylark-utils-dom/velm"],function(t){return t}),define("skylark-utils/widgets",["./skylark","./langx","./noder","./datax","./styler","./geom","./eventer","./query","./velm"],function(t,e,i,n,r,o,s,a,l){function u(){return u}function c(t,e,i){}var h=/^(\S+)\s*(.*)$/,d=(Array.prototype.slice,e.Evented.inherit({init:function(t,i){if(e.isHtmlNode(i)){var i=t;t=i}e.isHtmlNode(t)?this.el=t:this.el=null,i&&e.mixin(this,i),this.cid||(this.cid=e.uniqueId("w")),this._ensureElement()},tagName:"div",$:function(t){return this.$el.find(t)},render:function(){return this},remove:function(){return this._removeElement(),this.unlistenTo(),this},_removeElement:function(){this.$el.remove()},setElement:function(t){return this.undelegateEvents(),this._setElement(t),this.delegateEvents(),this},_setElement:function(t){this.$el=u.$(t),this.el=this.$el[0]},delegateEvents:function(t){if(t||(t=e.result(this,"events")),!t)return this;this.undelegateEvents();for(var i in t){var n=t[i];if(e.isFunction(n)||(n=this[n]),n){var r=i.match(h);this.delegate(r[1],r[2],e.proxy(n,this))}}return this},delegate:function(t,e,i){return this.$el.on(t+".delegateEvents"+this.uid,e,i),this},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.uid),this},undelegate:function(t,e,i){return this.$el.off(t+".delegateEvents"+this.uid,e,i),this},_createElement:function(t,e){return i.createElement(t,e)},_ensureElement:function(){if(this.el)this.setElement(e.result(this,"el"));else{var t=e.mixin({},e.result(this,"attributes"));this.id&&(t.id=e.result(this,"id")),this.className&&(t["class"]=e.result(this,"className")),this.setElement(this._createElement(e.result(this,"tagName"),t)),this._setAttributes(t)}},_setAttributes:function(t){this.$el.attr(t)},i18n:function(t,i){return t=this.messages&&this.messages[t]||t.toString(),i&&e.each(i,function(e,i){t=t.replace("{"+e+"}",i)}),t}}));return e.mixin(u,{$:a,define:c,Widget:d}),t.widgets=u}),define("skylark-ui-album/Album",["skylark-langx/skylark","skylark-langx/langx","skylark-utils/noder","skylark-utils/widgets"],function(t,e,i,n){var r={views:[],items:[]},o=n.Widget.inherit({klassName:"Album",options:{typeProperty:"type",titleProperty:"title",altTextProperty:"alt",urlProperty:"href",srcsetProperty:"urlset"},init:function(t,i){this.$el=$(t),this.el=this.$el[0],this.options=e.mixin({},o.prototype.options,i),this._itemFactories={},this.items=this.options.items,this.setViewMode(this.options.view.mode,this.options.view.options)},setViewMode:function(t,e){this.viewMode=t;for(var i=0;i<r.views.length;i++)if(r.views[i].name===t){this.view=new r.views[i].ctor(this,e);break}},getItemUrl:function(t){return o.getItemProperty(t,this.options.urlProperty)},getItemTitle:function(t){return o.getItemProperty(t,this.options.titleProperty)},addItems:function(t){t.concat||(t=Array.prototype.slice.call(t)),this.items.concat||(this.items=Array.prototype.slice.call(this.items)),this.items=this.items.concat(t),this.num=this.items.length,this.trigger("itemsChanged")},renderItem:function(t,e){var i=t&&o.getItemProperty(t,this.options.typeProperty);i&&(i=i.split("/")[0]),i||(i="image");var n=this._itemFactories[i];if(!n)for(var s=0;s<r.items.length;s++)if(r.items[s].mimeType===i){n=this._itemFactories[i]=new r.items[s].ctor(this);break}if(!n)throw new Error("invalid type:"+i);var a=n.render(t,e),l=o.getItemProperty(t,this.options.srcsetProperty);return l&&a.setAttribute("srcset",l),a},isRunnable:function(t){},playItem:function(t){}});e.mixin(o,{getNestedProperty:function(t,e){return e.replace(/\[(?:'([^']+)'|"([^"]+)"|(\d+))\]|(?:(?:^|\.)([^\.\[]+))/g,function(e,i,n,r,o){var s=o||i||n||r&&parseInt(r,10);e&&t&&(t=t[s])}),t},getDataProperty:function(t,e){var i,n;if(t.dataset?(i=e.replace(/-([a-z])/g,function(t,e){return e.toUpperCase()}),n=t.dataset[i]):t.getAttribute&&(n=t.getAttribute("data-"+e.replace(/([A-Z])/g,"-$1").toLowerCase())),"string"==typeof n){if(/^(true|false|null|-?\d+(\.\d+)?|\{[\s\S]*\}|\[[\s\S]*\])$/.test(n))try{return $.parseJSON(n)}catch(r){}return n}},getItemProperty:function(t,e){var i=this.getDataProperty(t,e);return void 0===i&&(i=t[e]),void 0===i&&(i=this.getNestedProperty(t,e)),i}});var s=o.ViewBase=e.Evented.inherit({klassName:"ViewBase",options:{controlsClass:"skylarkui-album-controls",fullScreen:!1},init:function(t,e){var n,r=this;this.album=t,this.initOptions(e),this.options.fullScreen&&i.fullScreen(this.container[0]),this.album.on("item.running",function(t){r.container.hasClass(r.options.controlsClass)?(n=!0,r.container.removeClass(r.options.controlsClass)):n=!1}),this.album.on("item.running",function(t){n&&r.container.addClass(r.options.controlsClass)})},initOptions:function(t){this.options=e.mixin({},s.prototype.options,t)},close:function(){i.fullScreen()===this.container[0]&&i.fullScreen(!1)}}),a=o.ItemFactoryBase=e.Evented.inherit({klassName:"ItemFactoryBase",options:{typeProperty:"type",titleProperty:"title",altTextProperty:"alt",urlProperty:"href",srcsetProperty:"urlset"},init:function(t,e){this.album=t,this.initOptions(e)},initOptions:function(t){this.options=e.mixin({},a.prototype.options,t)},setTimeout:function(t,e,i){var n=this;return t&&window.setTimeout(function(){t.apply(n,e||[])},i||0)},getNestedProperty:o.getNestedProperty,getDataProperty:o.getDataProperty,getItemProperty:o.getItemProperty});o.installPlugin=function(t,e){var i=r[t];if(!i)throw new Error("Invalid paramerter!");i.push(e)};var l=t.ui=t.ui||{};return l.Album=o}),define("skylark-ui-album/helper",["skylark-utils/langx","skylark-utils/query"],function(t,e){"use strict";return e.extend=t.mixin,e}),define("skylark-ui-album/plugins/items/image",["skylark-langx/langx","skylark-utils/noder","skylark-utils/query","../../Album"],function(t,e,i,n){var r=n.ItemFactoryBase.inherit({klassName:"ImageItemFactory",options:{stretchImages:!1},initOptions:function(e){this.overrided(),this.options=t.mixin(this.options,r.prototype.options,e)},render:function(t,n){function r(t){o||(t={type:t.type,target:s},o=!0,i(u).off("load error",r),h&&"load"===t.type&&(s.style.background='url("'+c+'") center no-repeat',s.style.backgroundSize=h),n(t))}var o,s,a,l,u=e.createElement("img"),c=(this.album,t),h=this.options.stretchImages;return"string"!=typeof c&&(c=this.getItemProperty(t,this.options.urlProperty),a=this.getItemProperty(t,this.options.titleProperty),l=this.getItemProperty(t,this.options.altTextProperty)||a),h===!0&&(h="contain"),h?s=e.createElement("div"):(s=u,u.draggable=!1),a&&(s.title=a),l&&(s.alt=l),i(u).on("load error",r),u.src=c,s}}),o={name:"image",mimeType:"image",ctor:r};return n.installPlugin("items",o),o}),define("skylark-ui-album/plugins/items/video",["skylark-langx/langx","skylark-utils/noder","skylark-utils/eventer","skylark-utils/query","../../Album"],function(t,e,i,n,r){"use strict";var o=r.ItemFactoryBase.inherit({klassName:"VideoItemFactory",options:{videoContentClass:"video-content",videoLoadingClass:"video-loading",videoPlayingClass:"video-playing",videoPosterProperty:"poster",videoSourcesProperty:"sources"},initOptions:function(e){this.overrided(),this.options=t.mixin(this.options,o.prototype.options,e)},handleSlide:function(t){handleSlide.call(this,t),this.playingVideo&&this.playingVideo.pause()},render:function(t,r,o){var s,a,l,u,c=this,h=this.options,d=e.createElement("div"),f=n(d),p=[{type:"error",target:d}],m=o||document.createElement("video"),v=this.getItemProperty(t,h.urlProperty),y=this.getItemProperty(t,h.typeProperty),g=this.getItemProperty(t,h.titleProperty),b=this.getItemProperty(t,this.options.altTextProperty)||g,w=this.getItemProperty(t,h.videoPosterProperty),k=this.getItemProperty(t,h.videoSourcesProperty);if(f.addClass(h.videoContentClass),g&&(d.title=g),m.canPlayType)if(v&&y&&m.canPlayType(y))m.src=v;else if(k)for(;k.length;)if(a=k.shift(),v=this.getItemProperty(a,h.urlProperty),y=this.getItemProperty(a,h.typeProperty),v&&y&&m.canPlayType(y)){m.src=v;break}return w&&(m.poster=w,s=e.createElement("img"),n(s).addClass(h.toggleClass),s.src=w,s.draggable=!1,s.alt=b,d.appendChild(s)),l=document.createElement("a"),l.setAttribute("target","_blank"),o||l.setAttribute("download",g),l.href=v,m.src&&(m.controls=!0,(o||n(m)).on("error",function(){c.setTimeout(r,p)}).on("pause",function(){m.seeking||(u=!1,f.removeClass(c.options.videoLoadingClass).removeClass(c.options.videoPlayingClass),c.album.trigger("item.pause",{item:c}),delete c.playingVideo,c.interval&&c.play())}).on("playing",function(){u=!1,f.removeClass(c.options.videoLoadingClass).addClass(c.options.videoPlayingClass),c.album.trigger("item.running",{item:c})}).on("play",function(){window.clearTimeout(c.timeout),u=!0,f.addClass(c.options.videoLoadingClass),c.playingVideo=m,c.album.trigger("item.run",{item:c})}),n(l).on("click",function(t){i.stop(t),u?m.pause():m.play()}),d.appendChild(o&&o.element||m)),d.appendChild(l),this.setTimeout(r,[{type:"load",target:d}]),d}}),s={name:"video",mimeType:"video",ctor:o};return r.installPlugin("items",s),s}),define("skylark-ui-album/plugins/items/vimeo",["skylark-langx/langx","skylark-utils/noder","skylark-utils/query","../../Album","./video"],function(t,e,i,n,r){"use strict";var o=t.Evented.inherit({klassName:"VimeoPlayer",init:function(t,e,i,n){this.url=t,this.videoId=e,this.playerId=i,this.clickToPlay=n,this.element=document.createElement("div"),this.listeners={}},canPlayType:function(){return!0},on:function(t,e){return this.listeners[t]=e,this},loadAPI:function(){function t(){!n&&r.playOnReady&&r.play(),n=!0}for(var e,n,r=this,o="//f.vimeocdn.com/js/froogaloop2.min.js",s=document.getElementsByTagName("script"),a=s.length;a;)if(a-=1,s[a].src===o){e=s[a];break}e||(e=document.createElement("script"),e.src=o),i(e).on("load",t),s[0].parentNode.insertBefore(e,s[0]),/loaded|complete/.test(e.readyState)&&t()},onReady:function(){var t=this;this.ready=!0,this.player.addEvent("play",function(){t.hasPlayed=!0,t.onPlaying()}),this.player.addEvent("pause",function(){t.onPause()}),this.player.addEvent("finish",function(){t.onPause()}),this.playOnReady&&this.play()},onPlaying:function(){this.playStatus<2&&(this.listeners.playing(),this.playStatus=2)},onPause:function(){this.listeners.pause(),delete this.playStatus},insertIframe:function(){var t=document.createElement("iframe");t.src=this.url.replace("VIDEO_ID",this.videoId).replace("PLAYER_ID",this.playerId),t.id=this.playerId,this.element.parentNode.replaceChild(t,this.element),this.element=t},play:function(){var t=this;this.playStatus||(this.listeners.play(),this.playStatus=1),this.ready?!this.hasPlayed&&(this.clickToPlay||window.navigator&&/iP(hone|od|ad)/.test(window.navigator.platform))?this.onPlaying():this.player.api("play"):(this.playOnReady=!0,window.$f?this.player||(this.insertIframe(),this.player=$f(this.element),this.player.addEvent("ready",function(){t.onReady()})):this.loadAPI())},pause:function(){this.ready?this.player.api("pause"):this.playStatus&&(delete this.playOnReady,this.listeners.pause(),delete this.playStatus)}}),s=0,a=r.ctor.inherit({klassName:"VimeoItemFactory",VimeoPlayer:o,options:{vimeoVideoIdProperty:"vimeo",vimeoPlayerUrl:"//player.vimeo.com/video/VIDEO_ID?api=1&player_id=PLAYER_ID",vimeoPlayerIdPrefix:"vimeo-player-",vimeoClickToPlay:!0},initOptions:function(e){this.overrided(),this.options=t.mixin(this.options,a.prototype.options,e)},render:function(t,e){var i=this.options,n=this.getItemProperty(t,i.vimeoVideoIdProperty);if(n)return void 0===this.getItemProperty(t,i.urlProperty)&&(t[i.urlProperty]="//vimeo.com/"+n),s+=1,this.overrided(t,e,new o(i.vimeoPlayerUrl,n,i.vimeoPlayerIdPrefix+s,i.vimeoClickToPlay))}}),l={name:"vimeo",mimeType:"vimeo",ctor:a};return n.installPlugin("items",l),l}),define("skylark-ui-album/plugins/items/youtube",["skylark-langx/langx","skylark-utils/noder","skylark-utils/query","../../Album","./video"],function(t,e,i,n,r){"use strict";var o=t.Evented.inherit({klassName:"YouTubePlayer",init:function(t,e,i){this.videoId=t,this.playerVars=e,this.clickToPlay=i,this.element=document.createElement("div")},canPlayType:function(){return!0},loadAPI:function(){var t,e=this,i=window.onYouTubeIframeAPIReady,n="https://www.youtube.com/iframe_api",r=document.getElementsByTagName("script"),o=r.length;for(window.onYouTubeIframeAPIReady=function(){i&&i.apply(this),e.playOnReady&&e.play()};o;)if(o-=1,r[o].src===n)return;t=document.createElement("script"),t.src=n,r[0].parentNode.insertBefore(t,r[0])},onReady:function(){this.ready=!0,this.playOnReady&&this.play()},onPlaying:function(){this.playStatus<2&&(this.listeners.playing(),this.playStatus=2)},onPause:function(){Gallery.prototype.setTimeout.call(this,this.checkSeek,null,2e3)},checkSeek:function(){this.stateChange!==YT.PlayerState.PAUSED&&this.stateChange!==YT.PlayerState.ENDED||(this.listeners.pause(),delete this.playStatus)},onStateChange:function(t){switch(t.data){case YT.PlayerState.PLAYING:this.hasPlayed=!0,this.onPlaying();break;case YT.PlayerState.PAUSED:case YT.PlayerState.ENDED:this.onPause()}this.stateChange=t.data},onError:function(t){this.trigger("error",t)},play:function(){var t=this;this.playStatus||(this.listeners.play(),this.playStatus=1),this.ready?!this.hasPlayed&&(this.clickToPlay||window.navigator&&/iP(hone|od|ad)/.test(window.navigator.platform))?this.onPlaying():this.player.playVideo():(this.playOnReady=!0,window.YT&&YT.Player?this.player||(this.player=new YT.Player(this.element,{videoId:this.videoId,playerVars:this.playerVars,events:{onReady:function(){t.onReady()},onStateChange:function(e){t.onStateChange(e)},onError:function(e){t.onError(e)}}})):this.loadAPI())},pause:function(){this.ready?this.player.pauseVideo():this.playStatus&&(delete this.playOnReady,this.listeners.pause(),delete this.playStatus)}}),s=r.ctor.inherit({klassName:"YouTubeItemFactory",YouTubePlayer:o,options:{youTubeVideoIdProperty:"youtube",youTubePlayerVars:{wmode:"transparent"},youTubeClickToPlay:!0},initOptions:function(e){this.overrided(),this.options=t.mixin(this.options,s.prototype.options,e)},render:function(t,e){var i=this.options,n=this.getItemProperty(t,i.youTubeVideoIdProperty);if(n)return void 0===this.getItemProperty(t,i.urlProperty)&&(t[i.urlProperty]="//www.youtube.com/watch?v="+n),void 0===this.getItemProperty(t,i.videoPosterProperty)&&(t[i.videoPosterProperty]="//img.youtube.com/vi/"+n+"/maxresdefault.jpg"),this.overrided(t,e,new o(n,i.youTubePlayerVars,i.youTubeClickToPlay))}}),a={name:"youtube",mimeType:"youtube",ctor:s};return n.installPlugin("items",a),a}),define("skylark-ui-album/plugins/views/SliderView",["skylark-langx/langx","../../helper","../../Album"],function(t,e,i){"use strict";var n=i.ViewBase.inherit({klassName:"SliderView",options:{container:null,slidesContainer:"div",titleElement:"h3",displayClass:"skylarkui-album-display",singleClass:"skylarkui-album-single",leftEdgeClass:"skylarkui-album-left",rightEdgeClass:"skylarkui-album-right",playingClass:"skylarkui-album-playing",slideClass:"slide",slideLoadingClass:"slide-loading",slideErrorClass:"slide-error",slideContentClass:"slide-content",toggleClass:"toggle",prevClass:"prev",nextClass:"next",closeClass:"close",playPauseClass:"play-pause",displayTransition:!0,clearSlides:!0,toggleControlsOnReturn:!0,toggleControlsOnSlideClick:!0,toggleSlideshowOnSpace:!0,enableKeyboardNavigation:!0,closeOnEscape:!0,closeOnSlideClick:!0,closeOnSwipeUpOrDown:!0,emulateTouchEvents:!0,stopTouchEventsPropagation:!1,hidePageScrollbars:!1,disableScroll:!0,carousel:!1,continuous:!0,unloadElements:!0,startSlideshow:!1,slideshowInterval:5e3,index:0,preloadRange:2,transitionSpeed:400,slideshowTransitionSpeed:void 0,event:void 0,onopen:void 0,onopened:void 0,onslide:void 0,onslideend:void 0,onslidecomplete:void 0,onclose:void 0,onclosed:void 0},console:window.console&&"function"==typeof window.console.log?window.console:{log:function(){}},support:function(t){function i(){var e,i,n=r.transition;document.body.appendChild(t),n&&(e=n.name.slice(0,-9)+"ransform",void 0!==t.style[e]&&(t.style[e]="translateZ(0)",i=window.getComputedStyle(t).getPropertyValue(n.prefix+"transform"),r.transform={prefix:n.prefix,name:e,translate:!0,translateZ:!!i&&"none"!==i})),void 0!==t.style.backgroundSize&&(r.backgroundSize={},t.style.backgroundSize="contain",r.backgroundSize.contain="contain"===window.getComputedStyle(t).getPropertyValue("background-size"),t.style.backgroundSize="cover",r.backgroundSize.cover="cover"===window.getComputedStyle(t).getPropertyValue("background-size")),document.body.removeChild(t)}var n,r={touch:void 0!==window.ontouchstart||window.DocumentTouch&&document instanceof DocumentTouch},o={webkitTransition:{end:"webkitTransitionEnd",prefix:"-webkit-"},MozTransition:{end:"transitionend",prefix:"-moz-"},OTransition:{end:"otransitionend",prefix:"-o-"},transition:{end:"transitionend",prefix:""}};for(n in o)if(o.hasOwnProperty(n)&&void 0!==t.style[n]){r.transition=o[n],r.transition.name=n;break}return document.body?i():e(document).on("DOMContentLoaded",i),r}(document.createElement("div")),requestAnimationFrame:window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame,
cancelAnimationFrame:window.cancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame,init:function(t,e){return this.overrided(t,e),this.list=this.album.items,this.options.container=this.album.el,this.num=this.list.length,this.initStartIndex(),this.initWidget()!==!1&&(this.initEventListeners(),this.onslide(this.index),this.ontransitionend(),void(this.options.startSlideshow&&this.play()))},slide:function(t,e){window.clearTimeout(this.timeout);var i,n,r,o=this.index;if(o!==t&&1!==this.num){if(e||(e=this.options.transitionSpeed),this.support.transform){for(this.options.continuous||(t=this.circle(t)),i=Math.abs(o-t)/(o-t),this.options.continuous&&(n=i,i=-this.positions[this.circle(t)]/this.slideWidth,i!==n&&(t=-i*this.num+t)),r=Math.abs(o-t)-1;r;)r-=1,this.move(this.circle((t>o?t:o)-r-1),this.slideWidth*i,0);t=this.circle(t),this.move(o,this.slideWidth*i,e),this.move(t,0,e),this.options.continuous&&this.move(this.circle(t-i),-(this.slideWidth*i),0)}else t=this.circle(t),this.animate(o*-this.slideWidth,t*-this.slideWidth,e);this.onslide(t)}},getIndex:function(){return this.index},getNumber:function(){return this.num},prev:function(){(this.options.continuous||this.index)&&this.slide(this.index-1)},next:function(){(this.options.continuous||this.index<this.num-1)&&this.slide(this.index+1)},play:function(t){var e=this;window.clearTimeout(this.timeout),this.interval=t||this.options.slideshowInterval,this.elements[this.index]>1&&(this.timeout=this.setTimeout(!this.requestAnimationFrame&&this.slide||function(t,i){e.animationFrameId=e.requestAnimationFrame.call(window,function(){e.slide(t,i)})},[this.index+1,this.options.slideshowTransitionSpeed],this.interval)),this.container.addClass(this.options.playingClass)},pause:function(){window.clearTimeout(this.timeout),this.interval=null,this.cancelAnimationFrame&&(this.cancelAnimationFrame.call(window,this.animationFrameId),this.animationFrameId=null),this.container.removeClass(this.options.playingClass)},add:function(t){var e;for(t.concat||(t=Array.prototype.slice.call(t)),this.list.concat||(this.list=Array.prototype.slice.call(this.list)),this.list=this.list.concat(t),this.num=this.list.length,this.num>2&&null===this.options.continuous&&(this.options.continuous=!0,this.container.removeClass(this.options.leftEdgeClass)),this.container.removeClass(this.options.rightEdgeClass).removeClass(this.options.singleClass),e=this.num-t.length;e<this.num;e+=1)this.addSlide(e),this.positionSlide(e);this.positions.length=this.num,this.initSlides(!0)},resetSlides:function(){this.slidesContainer.empty(),this.unloadAllSlides(),this.slides=[]},handleClose:function(){var t=this.options;this.destroyEventListeners(),this.pause(),this.container[0].style.display="none",this.container.removeClass(t.displayClass).removeClass(t.singleClass).removeClass(t.leftEdgeClass).removeClass(t.rightEdgeClass),t.hidePageScrollbars&&(document.body.style.overflow=this.bodyOverflowStyle),this.options.clearSlides&&this.resetSlides(),this.options.onclosed&&this.options.onclosed.call(this)},close:function(){function t(i){i.target===e.container[0]&&(e.container.off(e.support.transition.end,t),e.handleClose())}var e=this;this.options.onclose&&this.options.onclose.call(this),this.support.transition&&this.options.displayTransition?(this.container.on(this.support.transition.end,t),this.container.removeClass(this.options.displayClass)):this.handleClose()},circle:function(t){return(this.num+t%this.num)%this.num},move:function(t,e,i){this.translateX(t,e,i),this.positions[t]=e},translate:function(t,e,i,n){var r=this.slides[t].style,o=this.support.transition,s=this.support.transform;r[o.name+"Duration"]=n+"ms",r[s.name]="translate("+e+"px, "+i+"px)"+(s.translateZ?" translateZ(0)":"")},translateX:function(t,e,i){this.translate(t,e,0,i)},translateY:function(t,e,i){this.translate(t,0,e,i)},animate:function(t,e,i){if(!i)return void(this.slidesContainer[0].style.left=e+"px");var n=this,r=(new Date).getTime(),o=window.setInterval(function(){var s=(new Date).getTime()-r;return s>i?(n.slidesContainer[0].style.left=e+"px",n.ontransitionend(),void window.clearInterval(o)):void(n.slidesContainer[0].style.left=(e-t)*(Math.floor(s/i*100)/100)+t+"px")},4)},preventDefault:function(t){t.preventDefault?t.preventDefault():t.returnValue=!1},stopPropagation:function(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0},onresize:function(){this.initSlides(!0)},onmousedown:function(t){t.which&&1===t.which&&"VIDEO"!==t.target.nodeName&&"AUDIO"!==t.target.nodeName&&(t.preventDefault(),(t.originalEvent||t).touches=[{pageX:t.pageX,pageY:t.pageY}],this.ontouchstart(t))},onmousemove:function(t){this.touchStart&&((t.originalEvent||t).touches=[{pageX:t.pageX,pageY:t.pageY}],this.ontouchmove(t))},onmouseup:function(t){this.touchStart&&(this.ontouchend(t),delete this.touchStart)},onmouseout:function(t){if(this.touchStart){var i=t.target,n=t.relatedTarget;n&&(n===i||e.contains(i,n))||this.onmouseup(t)}},ontouchstart:function(t){this.options.stopTouchEventsPropagation&&this.stopPropagation(t);var e=(t.originalEvent||t).touches[0];this.touchStart={x:e.pageX,y:e.pageY,time:Date.now()},this.isScrolling=void 0,this.touchDelta={}},ontouchmove:function(t){this.options.stopTouchEventsPropagation&&this.stopPropagation(t);var e,i,n=(t.originalEvent||t).touches[0],r=(t.originalEvent||t).scale,o=this.index;if(!(n.length>1||r&&1!==r))if(this.options.disableScroll&&t.preventDefault(),this.touchDelta={x:n.pageX-this.touchStart.x,y:n.pageY-this.touchStart.y},e=this.touchDelta.x,void 0===this.isScrolling&&(this.isScrolling=this.isScrolling||Math.abs(e)<Math.abs(this.touchDelta.y)),this.isScrolling)this.translateY(o,this.touchDelta.y+this.positions[o],0);else for(t.preventDefault(),window.clearTimeout(this.timeout),this.options.continuous?i=[this.circle(o+1),o,this.circle(o-1)]:(this.touchDelta.x=e/=!o&&e>0||o===this.num-1&&e<0?Math.abs(e)/this.slideWidth+1:1,i=[o],o&&i.push(o-1),o<this.num-1&&i.unshift(o+1));i.length;)o=i.pop(),this.translateX(o,e+this.positions[o],0)},ontouchend:function(t){this.options.stopTouchEventsPropagation&&this.stopPropagation(t);var e,i,n,r,o,s=this.index,a=this.options.transitionSpeed,l=this.slideWidth,u=Number(Date.now()-this.touchStart.time)<250,c=u&&Math.abs(this.touchDelta.x)>20||Math.abs(this.touchDelta.x)>l/2,h=!s&&this.touchDelta.x>0||s===this.num-1&&this.touchDelta.x<0,d=!c&&this.options.closeOnSwipeUpOrDown&&(u&&Math.abs(this.touchDelta.y)>20||Math.abs(this.touchDelta.y)>this.slideHeight/2);this.options.continuous&&(h=!1),e=this.touchDelta.x<0?-1:1,this.isScrolling?d?this.close():this.translateY(s,0,a):c&&!h?(i=s+e,n=s-e,r=l*e,o=-l*e,this.options.continuous?(this.move(this.circle(i),r,0),this.move(this.circle(s-2*e),o,0)):i>=0&&i<this.num&&this.move(i,r,0),this.move(s,this.positions[s]+r,a),this.move(this.circle(n),this.positions[this.circle(n)]+r,a),s=this.circle(n),this.onslide(s)):this.options.continuous?(this.move(this.circle(s-1),-l,a),this.move(s,0,a),this.move(this.circle(s+1),l,a)):(s&&this.move(s-1,-l,a),this.move(s,0,a),s<this.num-1&&this.move(s+1,l,a))},ontouchcancel:function(t){this.touchStart&&(this.ontouchend(t),delete this.touchStart)},ontransitionend:function(t){var e=this.slides[this.index];t&&e!==t.target||(this.interval&&this.play(),this.setTimeout(this.options.onslideend,[this.index,e]))},oncomplete:function(t){var i,n=t.target||t.srcElement,r=n&&n.parentNode;n&&r&&(i=this.getNodeIndex(r),e(r).removeClass(this.options.slideLoadingClass),"error"===t.type?(e(r).addClass(this.options.slideErrorClass),this.elements[i]=3):this.elements[i]=2,n.clientHeight>this.container[0].clientHeight&&(n.style.maxHeight=this.container[0].clientHeight),this.interval&&this.slides[this.index]===r&&this.play(),this.setTimeout(this.options.onslidecomplete,[i,r]))},onload:function(t){this.oncomplete(t)},onerror:function(t){this.oncomplete(t)},onkeydown:function(t){switch(t.which||t.keyCode){case 13:this.options.toggleControlsOnReturn&&(this.preventDefault(t),this.toggleControls());break;case 27:this.options.closeOnEscape&&(this.close(),t.stopImmediatePropagation());break;case 32:this.options.toggleSlideshowOnSpace&&(this.preventDefault(t),this.toggleSlideshow());break;case 37:this.options.enableKeyboardNavigation&&(this.preventDefault(t),this.prev());break;case 39:this.options.enableKeyboardNavigation&&(this.preventDefault(t),this.next())}},handleClick:function(t){function i(t){return e(r).hasClass(t)||e(o).hasClass(t)}var n=this.options,r=t.target||t.srcElement,o=r.parentNode;i(n.toggleClass)?(this.preventDefault(t),this.toggleControls()):i(n.prevClass)?(this.preventDefault(t),this.prev()):i(n.nextClass)?(this.preventDefault(t),this.next()):i(n.closeClass)?(this.preventDefault(t),this.close()):i(n.playPauseClass)?(this.preventDefault(t),this.toggleSlideshow()):o===this.slidesContainer[0]?n.closeOnSlideClick?(this.preventDefault(t),this.close()):n.toggleControlsOnSlideClick&&(this.preventDefault(t),this.toggleControls()):o.parentNode&&o.parentNode===this.slidesContainer[0]&&n.toggleControlsOnSlideClick&&(this.preventDefault(t),this.toggleControls())},onclick:function(t){return this.options.emulateTouchEvents&&this.touchDelta&&(Math.abs(this.touchDelta.x)>20||Math.abs(this.touchDelta.y)>20)?void delete this.touchDelta:this.handleClick(t)},updateEdgeClasses:function(t){t?this.container.removeClass(this.options.leftEdgeClass):this.container.addClass(this.options.leftEdgeClass),t===this.num-1?this.container.addClass(this.options.rightEdgeClass):this.container.removeClass(this.options.rightEdgeClass)},handleSlide:function(t){this.options.continuous||this.updateEdgeClasses(t),this.loadElements(t),this.options.unloadElements&&this.unloadElements(t),this.setTitle(t)},onslide:function(t){this.index=t,this.handleSlide(t),this.setTimeout(this.options.onslide,[t,this.slides[t]])},setTitle:function(t){var e=this.slides[t].firstChild,i=e.title||e.alt,n=this.titleElement;n.length&&(this.titleElement.empty(),i&&n[0].appendChild(document.createTextNode(i)))},setTimeout:function(t,e,i){var n=this;return t&&window.setTimeout(function(){t.apply(n,e||[])},i||0)},createElement:function(t,i){var n=this.album.renderItem(t,i);return e(n).addClass(this.options.slideContentClass),n},loadElement:function(t){this.elements[t]||(this.slides[t].firstChild?this.elements[t]=e(this.slides[t]).hasClass(this.options.slideErrorClass)?3:2:(this.elements[t]=1,e(this.slides[t]).addClass(this.options.slideLoadingClass),this.slides[t].appendChild(this.createElement(this.list[t],this.proxyListener))))},loadElements:function(t){var e,i=Math.min(this.num,2*this.options.preloadRange+1),n=t;for(e=0;e<i;e+=1)n+=e*(e%2===0?-1:1),n=this.circle(n),this.loadElement(n)},unloadElements:function(t){var e,i;for(e in this.elements)this.elements.hasOwnProperty(e)&&(i=Math.abs(t-e),i>this.options.preloadRange&&i+this.options.preloadRange<this.num&&(this.unloadSlide(e),delete this.elements[e]))},addSlide:function(t){var e=this.slidePrototype.cloneNode(!1);e.setAttribute("data-index",t),this.slidesContainer[0].appendChild(e),this.slides.push(e)},positionSlide:function(t){var e=this.slides[t];e.style.width=this.slideWidth+"px",this.support.transform&&(e.style.left=t*-this.slideWidth+"px",this.move(t,this.index>t?-this.slideWidth:this.index<t?this.slideWidth:0,0))},initSlides:function(t){var i,n;for(t||(this.positions=[],this.positions.length=this.num,this.elements={},this.imagePrototype=document.createElement("img"),this.elementPrototype=document.createElement("div"),this.slidePrototype=document.createElement("div"),e(this.slidePrototype).addClass(this.options.slideClass),this.slides=this.slidesContainer[0].children,i=this.options.clearSlides||this.slides.length!==this.num),this.slideWidth=this.container[0].clientWidth,this.slideHeight=this.container[0].clientHeight,this.slidesContainer[0].style.width=this.num*this.slideWidth+"px",i&&this.resetSlides(),n=0;n<this.num;n+=1)i&&this.addSlide(n),this.positionSlide(n);this.options.continuous&&this.support.transform&&(this.move(this.circle(this.index-1),-this.slideWidth,0),this.move(this.circle(this.index+1),this.slideWidth,0)),this.support.transform||(this.slidesContainer[0].style.left=this.index*-this.slideWidth+"px")},unloadSlide:function(t){var e,i;e=this.slides[t],i=e.firstChild,null!==i&&e.removeChild(i)},unloadAllSlides:function(){var t,e;for(t=0,e=this.slides.length;t<e;t++)this.unloadSlide(t)},toggleControls:function(){var t=this.options.controlsClass;this.container.hasClass(t)?this.container.removeClass(t):this.container.addClass(t)},toggleSlideshow:function(){this.interval?this.pause():this.play()},getNodeIndex:function(t){return parseInt(t.getAttribute("data-index"),10)},initStartIndex:function(){var t,e=this.album,i=this.options.index;if(i&&"number"!=typeof i)for(t=0;t<this.num;t+=1)if(this.list[t]===i||e.getItemUrl(this.list[t])===e.getItemUrl(i)){i=t;break}this.index=this.circle(parseInt(i,10)||0)},initEventListeners:function(){function t(t){var e=i.support.transition&&i.support.transition.end===t.type?"transitionend":t.type;i["on"+e](t)}var i=this,n=this.slidesContainer;e(window).on("resize",t),e(document.body).on("keydown",t),this.container.on("click",t),this.support.touch?n.on("touchstart touchmove touchend touchcancel",t):this.options.emulateTouchEvents&&this.support.transition&&n.on("mousedown mousemove mouseup mouseout",t),this.support.transition&&n.on(this.support.transition.end,t),this.proxyListener=t},destroyEventListeners:function(){var t=this.slidesContainer,i=this.proxyListener;e(window).off("resize",i),e(document.body).off("keydown",i),this.container.off("click",i),this.support.touch?t.off("touchstart touchmove touchend touchcancel",i):this.options.emulateTouchEvents&&this.support.transition&&t.off("mousedown mousemove mouseup mouseout",i),this.support.transition&&t.off(this.support.transition.end,i)},handleOpen:function(){this.options.onopened&&this.options.onopened.call(this)},initWidget:function(){function t(e){e.target===i.container[0]&&(i.container.off(i.support.transition.end,t),i.handleOpen())}var i=this;return this.container=e(this.options.container),this.container.length?(this.slidesContainer=this.container.find(this.options.slidesContainer).first(),this.slidesContainer.length?(this.titleElement=this.container.find(this.options.titleElement).first(),1===this.num&&this.container.addClass(this.options.singleClass),this.options.onopen&&this.options.onopen.call(this),this.support.transition&&this.options.displayTransition?this.container.on(this.support.transition.end,t):this.handleOpen(),this.options.hidePageScrollbars&&(this.bodyOverflowStyle=document.body.style.overflow,document.body.style.overflow="hidden"),this.container[0].style.display="block",this.initSlides(),void this.container.addClass(this.options.displayClass)):(this.console.log("blueimp Gallery: Slides container not found.",this.options.slidesContainer),!1)):(this.console.log("blueimp Gallery: Widget container not found.",this.options.container),!1)},initOptions:function(e){this.overrided(t.mixin({},n.prototype.options,e)),this.num<3&&(this.options.continuous=!!this.options.continuous&&null),this.support.transition||(this.options.emulateTouchEvents=!1),this.options.event&&this.preventDefault(this.options.event)}});return i.installPlugin("views",{name:"slider",ctor:n,templates:{"default":'<div class="slides"></div><h3 class="title"></h3><a class="prev"></a><a class="next"></a><a class="close"></a><a class="play-pause"></a><ol class="indicator"></ol>'}}),i.SliderView=n}),define("skylark-ui-album/plugins/views/CarouselView",["../../Album","./SliderView"],function(t,e){var i=e.inherit({klassName:"CarouselView",options:{hidePageScrollbars:!1,toggleControlsOnReturn:!1,toggleSlideshowOnSpace:!1,enableKeyboardNavigation:!1,closeOnEscape:!1,closeOnSlideClick:!1,closeOnSwipeUpOrDown:!1,disableScroll:!1,startSlideshow:!0},initOptions:function(t){var t=langx.mixin({},i.prototype.options,t);this.overrided(t)}});return t.installPlugin("views",{name:"carousel",ctor:i,templates:{"default":'<div class="slides"></div><h3 class="title"></h3><a class="prev"></a><a class="next"></a><a class="close"></a><a class="play-pause"></a><ol class="indicator"></ol>'}}),i}),define("skylark-ui-album/plugins/views/LightBoxView",["skylark-langx/langx","../../Album","./SliderView"],function(t,e,i){var n=i.inherit({klassName:"LightBoxView",options:{hidePageScrollbars:!1,indicatorContainer:"ol",activeIndicatorClass:"active",thumbnailProperty:"thumbnail",thumbnailIndicators:!0},initOptions:function(e){var e=t.mixin({},n.prototype.options,e);this.overrided(e)},createIndicator:function(t){var i,n,r=this.album,o=this.indicatorPrototype.cloneNode(!1),s=r.getItemTitle(t),a=this.options.thumbnailProperty;return this.options.thumbnailIndicators&&(a&&(i=e.getItemProperty(t,a)),void 0===i&&(n=t.getElementsByTagName&&$(t).find("img")[0],n&&(i=n.src)),i&&(o.style.backgroundImage='url("'+i+'")')),s&&(o.title=s),o},addIndicator:function(t){if(this.indicatorContainer.length){var e=this.createIndicator(this.list[t]);e.setAttribute("data-index",t),this.indicatorContainer[0].appendChild(e),this.indicators.push(e)}},setActiveIndicator:function(t){this.indicators&&(this.activeIndicator&&this.activeIndicator.removeClass(this.options.activeIndicatorClass),this.activeIndicator=$(this.indicators[t]),this.activeIndicator.addClass(this.options.activeIndicatorClass))},initSlides:function(t){t||(this.indicatorContainer=this.container.find(this.options.indicatorContainer),this.indicatorContainer.length&&(this.indicatorPrototype=document.createElement("li"),this.indicators=this.indicatorContainer[0].children)),this.overrided(t)},addSlide:function(t){this.overrided(t),this.addIndicator(t)},resetSlides:function(){this.overrided(),this.indicatorContainer.empty(),this.indicators=[]},handleClick:function(t){var e=t.target||t.srcElement,i=e.parentNode;if(i===this.indicatorContainer[0])this.preventDefault(t),this.slide(this.getNodeIndex(e));else{if(i.parentNode!==this.indicatorContainer[0])return this.overrided(t);this.preventDefault(t),this.slide(this.getNodeIndex(i))}},handleSlide:function(t){this.overrided(t),this.setActiveIndicator(t)},handleClose:function(){this.activeIndicator&&this.activeIndicator.removeClass(this.options.activeIndicatorClass),this.overrided()}});return e.installPlugin("views",{name:"lightbox",ctor:n,templates:{"default":'<div class="slides"></div><h3 class="title"></h3><a class="prev"></a><a class="next"></a><a class="close"></a><ol class="indicator"></ol>'}}),n}),define("skylark-ui-album/main",["./Album","./helper","./plugins/items/image","./plugins/items/video","./plugins/items/vimeo","./plugins/items/youtube","./plugins/views/SliderView","./plugins/views/CarouselView","./plugins/views/LightBoxView"],function(t){return t}),define("skylark-ui-album",["skylark-ui-album/main"],function(t){return t})},this);
//# sourceMappingURL=sourcemaps/skylark-ui-album-all.js.map
