/**
 * skylark-ui-album - The skylark album widgets.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
!function(t,i){function e(t,i){if("."!==t[0])return t;var e=i.split("/"),s=t.split("/");e.pop();for(var n=0;n<s.length;n++)"."!=s[n]&&(".."==s[n]?e.pop():e.push(s[n]));return e.join("/")}var s=i.define,n=i.require,o="function"==typeof s&&s.amd,a=!o&&"undefined"!=typeof exports;if(!o&&!s){var r={};s=i.define=function(t,i,s){"function"==typeof s?(r[t]={factory:s,deps:i.map(function(i){return e(i,t)}),exports:null},n(t)):r[t]=s},n=i.require=function(t){if(!r.hasOwnProperty(t))throw new Error("Module "+t+" has not been defined");var i=r[t];if(!i.exports){var e=[];i.deps.forEach(function(t){e.push(n(t))}),i.exports=i.factory.apply(window,e)}return i.exports}}if(!s)throw new Error("The module utility (ex: requirejs or skylark-utils) is not loaded!");if(t(s,n),!o){var l=n("skylark-langx/skylark");a?exports=l:i.skylarkjs=l}}(function(t,i){t("skylark-ui-album/Album",["skylark-langx/skylark","skylark-langx/langx","skylark-utils/noder","skylark-utils/widgets"],function(t,i,e,s){var n={views:[],items:[]},o=s.Widget.inherit({klassName:"Album",options:{typeProperty:"type",titleProperty:"title",altTextProperty:"alt",urlProperty:"href",srcsetProperty:"urlset"},init:function(t,e){this.$el=$(t),this.el=this.$el[0],this.options=i.mixin({},o.prototype.options,e),this._itemFactories={},this.items=this.options.items,this.setViewMode(this.options.view.mode,this.options.view.options)},setViewMode:function(t,i){this.viewMode=t;for(var e=0;e<n.views.length;e++)if(n.views[e].name===t){this.view=new n.views[e].ctor(this,i);break}},getItemUrl:function(t){return o.getItemProperty(t,this.options.urlProperty)},getItemTitle:function(t){return o.getItemProperty(t,this.options.titleProperty)},addItems:function(t){t.concat||(t=Array.prototype.slice.call(t)),this.items.concat||(this.items=Array.prototype.slice.call(this.items)),this.items=this.items.concat(t),this.num=this.items.length,this.trigger("itemsChanged")},renderItem:function(t,i){var e=t&&o.getItemProperty(t,this.options.typeProperty);e&&(e=e.split("/")[0]),e||(e="image");var s=this._itemFactories[e];if(!s)for(var a=0;a<n.items.length;a++)if(n.items[a].mimeType===e){s=this._itemFactories[e]=new n.items[a].ctor(this);break}if(!s)throw new Error("invalid type:"+e);var r=s.render(t,i),l=o.getItemProperty(t,this.options.srcsetProperty);return l&&r.setAttribute("srcset",l),r},isRunnable:function(t){},playItem:function(t){}});i.mixin(o,{getNestedProperty:function(t,i){return i.replace(/\[(?:'([^']+)'|"([^"]+)"|(\d+))\]|(?:(?:^|\.)([^\.\[]+))/g,function(i,e,s,n,o){var a=o||e||s||n&&parseInt(n,10);i&&t&&(t=t[a])}),t},getDataProperty:function(t,i){var e,s;if(t.dataset?(e=i.replace(/-([a-z])/g,function(t,i){return i.toUpperCase()}),s=t.dataset[e]):t.getAttribute&&(s=t.getAttribute("data-"+i.replace(/([A-Z])/g,"-$1").toLowerCase())),"string"==typeof s){if(/^(true|false|null|-?\d+(\.\d+)?|\{[\s\S]*\}|\[[\s\S]*\])$/.test(s))try{return $.parseJSON(s)}catch(n){}return s}},getItemProperty:function(t,i){var e=this.getDataProperty(t,i);return void 0===e&&(e=t[i]),void 0===e&&(e=this.getNestedProperty(t,i)),e}});var a=o.ViewBase=i.Evented.inherit({klassName:"ViewBase",options:{controlsClass:"skylarkui-album-controls",fullScreen:!1},init:function(t,i){var s,n=this;this.album=t,this.initOptions(i),this.options.fullScreen&&e.fullScreen(this.container[0]),this.album.on("item.running",function(t){n.container.hasClass(n.options.controlsClass)?(s=!0,n.container.removeClass(n.options.controlsClass)):s=!1}),this.album.on("item.running",function(t){s&&n.container.addClass(n.options.controlsClass)})},initOptions:function(t){this.options=i.mixin({},a.prototype.options,t)},close:function(){e.fullScreen()===this.container[0]&&e.fullScreen(!1)}}),r=o.ItemFactoryBase=i.Evented.inherit({klassName:"ItemFactoryBase",options:{typeProperty:"type",titleProperty:"title",altTextProperty:"alt",urlProperty:"href",srcsetProperty:"urlset"},init:function(t,i){this.album=t,this.initOptions(i)},initOptions:function(t){this.options=i.mixin({},r.prototype.options,t)},setTimeout:function(t,i,e){var s=this;return t&&window.setTimeout(function(){t.apply(s,i||[])},e||0)},getNestedProperty:o.getNestedProperty,getDataProperty:o.getDataProperty,getItemProperty:o.getItemProperty});o.installPlugin=function(t,i){var e=n[t];if(!e)throw new Error("Invalid paramerter!");e.push(i)};var l=t.ui=t.ui||{};return l.Album=o}),t("skylark-ui-album/helper",["skylark-utils/langx","skylark-utils/query"],function(t,i){"use strict";return i.extend=t.mixin,i}),t("skylark-ui-album/plugins/items/image",["skylark-langx/langx","skylark-utils/noder","skylark-utils/query","../../Album"],function(t,i,e,s){var n=s.ItemFactoryBase.inherit({klassName:"ImageItemFactory",options:{stretchImages:!1},initOptions:function(i){this.overrided(),this.options=t.mixin(this.options,n.prototype.options,i)},render:function(t,s){function n(t){o||(t={type:t.type,target:a},o=!0,e(h).off("load error",n),u&&"load"===t.type&&(a.style.background='url("'+d+'") center no-repeat',a.style.backgroundSize=u),s(t))}var o,a,r,l,h=i.createElement("img"),d=(this.album,t),u=this.options.stretchImages;return"string"!=typeof d&&(d=this.getItemProperty(t,this.options.urlProperty),r=this.getItemProperty(t,this.options.titleProperty),l=this.getItemProperty(t,this.options.altTextProperty)||r),u===!0&&(u="contain"),u?a=i.createElement("div"):(a=h,h.draggable=!1),r&&(a.title=r),l&&(a.alt=l),e(h).on("load error",n),h.src=d,a}}),o={name:"image",mimeType:"image",ctor:n};return s.installPlugin("items",o),o}),t("skylark-ui-album/plugins/items/video",["skylark-langx/langx","skylark-utils/noder","skylark-utils/eventer","skylark-utils/query","../../Album"],function(t,i,e,s,n){"use strict";var o=n.ItemFactoryBase.inherit({klassName:"VideoItemFactory",options:{videoContentClass:"video-content",videoLoadingClass:"video-loading",videoPlayingClass:"video-playing",videoPosterProperty:"poster",videoSourcesProperty:"sources"},initOptions:function(i){this.overrided(),this.options=t.mixin(this.options,o.prototype.options,i)},handleSlide:function(t){handleSlide.call(this,t),this.playingVideo&&this.playingVideo.pause()},render:function(t,n,o){var a,r,l,h,d=this,u=this.options,c=i.createElement("div"),p=s(c),m=[{type:"error",target:c}],y=o||document.createElement("video"),g=this.getItemProperty(t,u.urlProperty),v=this.getItemProperty(t,u.typeProperty),f=this.getItemProperty(t,u.titleProperty),C=this.getItemProperty(t,this.options.altTextProperty)||f,w=this.getItemProperty(t,u.videoPosterProperty),P=this.getItemProperty(t,u.videoSourcesProperty);if(p.addClass(u.videoContentClass),f&&(c.title=f),y.canPlayType)if(g&&v&&y.canPlayType(v))y.src=g;else if(P)for(;P.length;)if(r=P.shift(),g=this.getItemProperty(r,u.urlProperty),v=this.getItemProperty(r,u.typeProperty),g&&v&&y.canPlayType(v)){y.src=g;break}return w&&(y.poster=w,a=i.createElement("img"),s(a).addClass(u.toggleClass),a.src=w,a.draggable=!1,a.alt=C,c.appendChild(a)),l=document.createElement("a"),l.setAttribute("target","_blank"),o||l.setAttribute("download",f),l.href=g,y.src&&(y.controls=!0,(o||s(y)).on("error",function(){d.setTimeout(n,m)}).on("pause",function(){y.seeking||(h=!1,p.removeClass(d.options.videoLoadingClass).removeClass(d.options.videoPlayingClass),d.album.trigger("item.pause",{item:d}),delete d.playingVideo,d.interval&&d.play())}).on("playing",function(){h=!1,p.removeClass(d.options.videoLoadingClass).addClass(d.options.videoPlayingClass),d.album.trigger("item.running",{item:d})}).on("play",function(){window.clearTimeout(d.timeout),h=!0,p.addClass(d.options.videoLoadingClass),d.playingVideo=y,d.album.trigger("item.run",{item:d})}),s(l).on("click",function(t){e.stop(t),h?y.pause():y.play()}),c.appendChild(o&&o.element||y)),c.appendChild(l),this.setTimeout(n,[{type:"load",target:c}]),c}}),a={name:"video",mimeType:"video",ctor:o};return n.installPlugin("items",a),a}),t("skylark-ui-album/plugins/items/vimeo",["skylark-langx/langx","skylark-utils/noder","skylark-utils/query","../../Album","./video"],function(t,i,e,s,n){"use strict";var o=t.Evented.inherit({klassName:"VimeoPlayer",init:function(t,i,e,s){this.url=t,this.videoId=i,this.playerId=e,this.clickToPlay=s,this.element=document.createElement("div"),this.listeners={}},canPlayType:function(){return!0},on:function(t,i){return this.listeners[t]=i,this},loadAPI:function(){function t(){!s&&n.playOnReady&&n.play(),s=!0}for(var i,s,n=this,o="//f.vimeocdn.com/js/froogaloop2.min.js",a=document.getElementsByTagName("script"),r=a.length;r;)if(r-=1,a[r].src===o){i=a[r];break}i||(i=document.createElement("script"),i.src=o),e(i).on("load",t),a[0].parentNode.insertBefore(i,a[0]),/loaded|complete/.test(i.readyState)&&t()},onReady:function(){var t=this;this.ready=!0,this.player.addEvent("play",function(){t.hasPlayed=!0,t.onPlaying()}),this.player.addEvent("pause",function(){t.onPause()}),this.player.addEvent("finish",function(){t.onPause()}),this.playOnReady&&this.play()},onPlaying:function(){this.playStatus<2&&(this.listeners.playing(),this.playStatus=2)},onPause:function(){this.listeners.pause(),delete this.playStatus},insertIframe:function(){var t=document.createElement("iframe");t.src=this.url.replace("VIDEO_ID",this.videoId).replace("PLAYER_ID",this.playerId),t.id=this.playerId,this.element.parentNode.replaceChild(t,this.element),this.element=t},play:function(){var t=this;this.playStatus||(this.listeners.play(),this.playStatus=1),this.ready?!this.hasPlayed&&(this.clickToPlay||window.navigator&&/iP(hone|od|ad)/.test(window.navigator.platform))?this.onPlaying():this.player.api("play"):(this.playOnReady=!0,window.$f?this.player||(this.insertIframe(),this.player=$f(this.element),this.player.addEvent("ready",function(){t.onReady()})):this.loadAPI())},pause:function(){this.ready?this.player.api("pause"):this.playStatus&&(delete this.playOnReady,this.listeners.pause(),delete this.playStatus)}}),a=0,r=n.ctor.inherit({klassName:"VimeoItemFactory",VimeoPlayer:o,options:{vimeoVideoIdProperty:"vimeo",vimeoPlayerUrl:"//player.vimeo.com/video/VIDEO_ID?api=1&player_id=PLAYER_ID",vimeoPlayerIdPrefix:"vimeo-player-",vimeoClickToPlay:!0},initOptions:function(i){this.overrided(),this.options=t.mixin(this.options,r.prototype.options,i)},render:function(t,i){var e=this.options,s=this.getItemProperty(t,e.vimeoVideoIdProperty);if(s)return void 0===this.getItemProperty(t,e.urlProperty)&&(t[e.urlProperty]="//vimeo.com/"+s),a+=1,this.overrided(t,i,new o(e.vimeoPlayerUrl,s,e.vimeoPlayerIdPrefix+a,e.vimeoClickToPlay))}}),l={name:"vimeo",mimeType:"vimeo",ctor:r};return s.installPlugin("items",l),l}),t("skylark-ui-album/plugins/items/youtube",["skylark-langx/langx","skylark-utils/noder","skylark-utils/query","../../Album","./video"],function(t,i,e,s,n){"use strict";var o=t.Evented.inherit({klassName:"YouTubePlayer",init:function(t,i,e){this.videoId=t,this.playerVars=i,this.clickToPlay=e,this.element=document.createElement("div")},canPlayType:function(){return!0},loadAPI:function(){var t,i=this,e=window.onYouTubeIframeAPIReady,s="https://www.youtube.com/iframe_api",n=document.getElementsByTagName("script"),o=n.length;for(window.onYouTubeIframeAPIReady=function(){e&&e.apply(this),i.playOnReady&&i.play()};o;)if(o-=1,n[o].src===s)return;t=document.createElement("script"),t.src=s,n[0].parentNode.insertBefore(t,n[0])},onReady:function(){this.ready=!0,this.playOnReady&&this.play()},onPlaying:function(){this.playStatus<2&&(this.listeners.playing(),this.playStatus=2)},onPause:function(){Gallery.prototype.setTimeout.call(this,this.checkSeek,null,2e3)},checkSeek:function(){this.stateChange!==YT.PlayerState.PAUSED&&this.stateChange!==YT.PlayerState.ENDED||(this.listeners.pause(),delete this.playStatus)},onStateChange:function(t){switch(t.data){case YT.PlayerState.PLAYING:this.hasPlayed=!0,this.onPlaying();break;case YT.PlayerState.PAUSED:case YT.PlayerState.ENDED:this.onPause()}this.stateChange=t.data},onError:function(t){this.trigger("error",t)},play:function(){var t=this;this.playStatus||(this.listeners.play(),this.playStatus=1),this.ready?!this.hasPlayed&&(this.clickToPlay||window.navigator&&/iP(hone|od|ad)/.test(window.navigator.platform))?this.onPlaying():this.player.playVideo():(this.playOnReady=!0,window.YT&&YT.Player?this.player||(this.player=new YT.Player(this.element,{videoId:this.videoId,playerVars:this.playerVars,events:{onReady:function(){t.onReady()},onStateChange:function(i){t.onStateChange(i)},onError:function(i){t.onError(i)}}})):this.loadAPI())},pause:function(){this.ready?this.player.pauseVideo():this.playStatus&&(delete this.playOnReady,this.listeners.pause(),delete this.playStatus)}}),a=n.ctor.inherit({klassName:"YouTubeItemFactory",YouTubePlayer:o,options:{youTubeVideoIdProperty:"youtube",youTubePlayerVars:{wmode:"transparent"},youTubeClickToPlay:!0},initOptions:function(i){this.overrided(),this.options=t.mixin(this.options,a.prototype.options,i)},render:function(t,i){var e=this.options,s=this.getItemProperty(t,e.youTubeVideoIdProperty);if(s)return void 0===this.getItemProperty(t,e.urlProperty)&&(t[e.urlProperty]="//www.youtube.com/watch?v="+s),void 0===this.getItemProperty(t,e.videoPosterProperty)&&(t[e.videoPosterProperty]="//img.youtube.com/vi/"+s+"/maxresdefault.jpg"),this.overrided(t,i,new o(s,e.youTubePlayerVars,e.youTubeClickToPlay))}}),r={name:"youtube",mimeType:"youtube",ctor:a};return s.installPlugin("items",r),r}),t("skylark-ui-album/plugins/views/SliderView",["skylark-langx/langx","../../helper","../../Album"],function(t,i,e){"use strict";var s=e.ViewBase.inherit({klassName:"SliderView",options:{container:null,slidesContainer:"div",titleElement:"h3",displayClass:"skylarkui-album-display",singleClass:"skylarkui-album-single",leftEdgeClass:"skylarkui-album-left",rightEdgeClass:"skylarkui-album-right",playingClass:"skylarkui-album-playing",slideClass:"slide",slideLoadingClass:"slide-loading",slideErrorClass:"slide-error",slideContentClass:"slide-content",toggleClass:"toggle",prevClass:"prev",nextClass:"next",closeClass:"close",playPauseClass:"play-pause",displayTransition:!0,clearSlides:!0,toggleControlsOnReturn:!0,toggleControlsOnSlideClick:!0,toggleSlideshowOnSpace:!0,enableKeyboardNavigation:!0,closeOnEscape:!0,closeOnSlideClick:!0,closeOnSwipeUpOrDown:!0,emulateTouchEvents:!0,stopTouchEventsPropagation:!1,hidePageScrollbars:!1,disableScroll:!0,carousel:!1,continuous:!0,unloadElements:!0,startSlideshow:!1,slideshowInterval:5e3,index:0,preloadRange:2,transitionSpeed:400,slideshowTransitionSpeed:void 0,event:void 0,onopen:void 0,onopened:void 0,onslide:void 0,onslideend:void 0,onslidecomplete:void 0,onclose:void 0,onclosed:void 0},console:window.console&&"function"==typeof window.console.log?window.console:{log:function(){}},support:function(t){function e(){var i,e,s=n.transition;document.body.appendChild(t),s&&(i=s.name.slice(0,-9)+"ransform",void 0!==t.style[i]&&(t.style[i]="translateZ(0)",e=window.getComputedStyle(t).getPropertyValue(s.prefix+"transform"),n.transform={prefix:s.prefix,name:i,translate:!0,translateZ:!!e&&"none"!==e})),void 0!==t.style.backgroundSize&&(n.backgroundSize={},t.style.backgroundSize="contain",n.backgroundSize.contain="contain"===window.getComputedStyle(t).getPropertyValue("background-size"),t.style.backgroundSize="cover",n.backgroundSize.cover="cover"===window.getComputedStyle(t).getPropertyValue("background-size")),document.body.removeChild(t)}var s,n={touch:void 0!==window.ontouchstart||window.DocumentTouch&&document instanceof DocumentTouch},o={webkitTransition:{end:"webkitTransitionEnd",prefix:"-webkit-"},MozTransition:{end:"transitionend",prefix:"-moz-"},OTransition:{end:"otransitionend",prefix:"-o-"},transition:{end:"transitionend",prefix:""}};for(s in o)if(o.hasOwnProperty(s)&&void 0!==t.style[s]){n.transition=o[s],n.transition.name=s;break}return document.body?e():i(document).on("DOMContentLoaded",e),n}(document.createElement("div")),requestAnimationFrame:window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame,cancelAnimationFrame:window.cancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame,init:function(t,i){return this.overrided(t,i),this.list=this.album.items,this.options.container=this.album.el,this.num=this.list.length,this.initStartIndex(),this.initWidget()!==!1&&(this.initEventListeners(),this.onslide(this.index),this.ontransitionend(),void(this.options.startSlideshow&&this.play()))},slide:function(t,i){window.clearTimeout(this.timeout);var e,s,n,o=this.index;if(o!==t&&1!==this.num){if(i||(i=this.options.transitionSpeed),this.support.transform){for(this.options.continuous||(t=this.circle(t)),e=Math.abs(o-t)/(o-t),this.options.continuous&&(s=e,e=-this.positions[this.circle(t)]/this.slideWidth,e!==s&&(t=-e*this.num+t)),n=Math.abs(o-t)-1;n;)n-=1,this.move(this.circle((t>o?t:o)-n-1),this.slideWidth*e,0);t=this.circle(t),this.move(o,this.slideWidth*e,i),this.move(t,0,i),this.options.continuous&&this.move(this.circle(t-e),-(this.slideWidth*e),0)}else t=this.circle(t),this.animate(o*-this.slideWidth,t*-this.slideWidth,i);this.onslide(t)}},getIndex:function(){return this.index},getNumber:function(){return this.num},prev:function(){(this.options.continuous||this.index)&&this.slide(this.index-1)},next:function(){(this.options.continuous||this.index<this.num-1)&&this.slide(this.index+1)},play:function(t){var i=this;window.clearTimeout(this.timeout),this.interval=t||this.options.slideshowInterval,this.elements[this.index]>1&&(this.timeout=this.setTimeout(!this.requestAnimationFrame&&this.slide||function(t,e){i.animationFrameId=i.requestAnimationFrame.call(window,function(){i.slide(t,e)})},[this.index+1,this.options.slideshowTransitionSpeed],this.interval)),this.container.addClass(this.options.playingClass)},pause:function(){window.clearTimeout(this.timeout),this.interval=null,this.cancelAnimationFrame&&(this.cancelAnimationFrame.call(window,this.animationFrameId),this.animationFrameId=null),this.container.removeClass(this.options.playingClass)},add:function(t){var i;for(t.concat||(t=Array.prototype.slice.call(t)),this.list.concat||(this.list=Array.prototype.slice.call(this.list)),this.list=this.list.concat(t),this.num=this.list.length,this.num>2&&null===this.options.continuous&&(this.options.continuous=!0,this.container.removeClass(this.options.leftEdgeClass)),this.container.removeClass(this.options.rightEdgeClass).removeClass(this.options.singleClass),i=this.num-t.length;i<this.num;i+=1)this.addSlide(i),this.positionSlide(i);this.positions.length=this.num,this.initSlides(!0)},resetSlides:function(){this.slidesContainer.empty(),this.unloadAllSlides(),this.slides=[]},handleClose:function(){var t=this.options;this.destroyEventListeners(),this.pause(),this.container[0].style.display="none",this.container.removeClass(t.displayClass).removeClass(t.singleClass).removeClass(t.leftEdgeClass).removeClass(t.rightEdgeClass),t.hidePageScrollbars&&(document.body.style.overflow=this.bodyOverflowStyle),this.options.clearSlides&&this.resetSlides(),this.options.onclosed&&this.options.onclosed.call(this)},close:function(){function t(e){e.target===i.container[0]&&(i.container.off(i.support.transition.end,t),i.handleClose())}var i=this;this.options.onclose&&this.options.onclose.call(this),this.support.transition&&this.options.displayTransition?(this.container.on(this.support.transition.end,t),this.container.removeClass(this.options.displayClass)):this.handleClose()},circle:function(t){return(this.num+t%this.num)%this.num},move:function(t,i,e){this.translateX(t,i,e),this.positions[t]=i},translate:function(t,i,e,s){var n=this.slides[t].style,o=this.support.transition,a=this.support.transform;n[o.name+"Duration"]=s+"ms",n[a.name]="translate("+i+"px, "+e+"px)"+(a.translateZ?" translateZ(0)":"")},translateX:function(t,i,e){this.translate(t,i,0,e)},translateY:function(t,i,e){this.translate(t,0,i,e)},animate:function(t,i,e){if(!e)return void(this.slidesContainer[0].style.left=i+"px");var s=this,n=(new Date).getTime(),o=window.setInterval(function(){var a=(new Date).getTime()-n;return a>e?(s.slidesContainer[0].style.left=i+"px",s.ontransitionend(),void window.clearInterval(o)):void(s.slidesContainer[0].style.left=(i-t)*(Math.floor(a/e*100)/100)+t+"px")},4)},preventDefault:function(t){t.preventDefault?t.preventDefault():t.returnValue=!1},stopPropagation:function(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0},onresize:function(){this.initSlides(!0)},onmousedown:function(t){t.which&&1===t.which&&"VIDEO"!==t.target.nodeName&&"AUDIO"!==t.target.nodeName&&(t.preventDefault(),(t.originalEvent||t).touches=[{pageX:t.pageX,pageY:t.pageY}],this.ontouchstart(t))},onmousemove:function(t){this.touchStart&&((t.originalEvent||t).touches=[{pageX:t.pageX,pageY:t.pageY}],this.ontouchmove(t))},onmouseup:function(t){this.touchStart&&(this.ontouchend(t),delete this.touchStart)},onmouseout:function(t){if(this.touchStart){var e=t.target,s=t.relatedTarget;s&&(s===e||i.contains(e,s))||this.onmouseup(t)}},ontouchstart:function(t){this.options.stopTouchEventsPropagation&&this.stopPropagation(t);var i=(t.originalEvent||t).touches[0];this.touchStart={x:i.pageX,y:i.pageY,time:Date.now()},this.isScrolling=void 0,this.touchDelta={}},ontouchmove:function(t){this.options.stopTouchEventsPropagation&&this.stopPropagation(t);var i,e,s=(t.originalEvent||t).touches[0],n=(t.originalEvent||t).scale,o=this.index;if(!(s.length>1||n&&1!==n))if(this.options.disableScroll&&t.preventDefault(),this.touchDelta={x:s.pageX-this.touchStart.x,y:s.pageY-this.touchStart.y},i=this.touchDelta.x,void 0===this.isScrolling&&(this.isScrolling=this.isScrolling||Math.abs(i)<Math.abs(this.touchDelta.y)),this.isScrolling)this.translateY(o,this.touchDelta.y+this.positions[o],0);else for(t.preventDefault(),window.clearTimeout(this.timeout),this.options.continuous?e=[this.circle(o+1),o,this.circle(o-1)]:(this.touchDelta.x=i/=!o&&i>0||o===this.num-1&&i<0?Math.abs(i)/this.slideWidth+1:1,e=[o],o&&e.push(o-1),o<this.num-1&&e.unshift(o+1));e.length;)o=e.pop(),this.translateX(o,i+this.positions[o],0)},ontouchend:function(t){this.options.stopTouchEventsPropagation&&this.stopPropagation(t);var i,e,s,n,o,a=this.index,r=this.options.transitionSpeed,l=this.slideWidth,h=Number(Date.now()-this.touchStart.time)<250,d=h&&Math.abs(this.touchDelta.x)>20||Math.abs(this.touchDelta.x)>l/2,u=!a&&this.touchDelta.x>0||a===this.num-1&&this.touchDelta.x<0,c=!d&&this.options.closeOnSwipeUpOrDown&&(h&&Math.abs(this.touchDelta.y)>20||Math.abs(this.touchDelta.y)>this.slideHeight/2);this.options.continuous&&(u=!1),i=this.touchDelta.x<0?-1:1,this.isScrolling?c?this.close():this.translateY(a,0,r):d&&!u?(e=a+i,s=a-i,n=l*i,o=-l*i,this.options.continuous?(this.move(this.circle(e),n,0),this.move(this.circle(a-2*i),o,0)):e>=0&&e<this.num&&this.move(e,n,0),this.move(a,this.positions[a]+n,r),this.move(this.circle(s),this.positions[this.circle(s)]+n,r),a=this.circle(s),this.onslide(a)):this.options.continuous?(this.move(this.circle(a-1),-l,r),this.move(a,0,r),this.move(this.circle(a+1),l,r)):(a&&this.move(a-1,-l,r),this.move(a,0,r),a<this.num-1&&this.move(a+1,l,r))},ontouchcancel:function(t){this.touchStart&&(this.ontouchend(t),delete this.touchStart)},ontransitionend:function(t){var i=this.slides[this.index];t&&i!==t.target||(this.interval&&this.play(),this.setTimeout(this.options.onslideend,[this.index,i]))},oncomplete:function(t){var e,s=t.target||t.srcElement,n=s&&s.parentNode;s&&n&&(e=this.getNodeIndex(n),i(n).removeClass(this.options.slideLoadingClass),"error"===t.type?(i(n).addClass(this.options.slideErrorClass),this.elements[e]=3):this.elements[e]=2,s.clientHeight>this.container[0].clientHeight&&(s.style.maxHeight=this.container[0].clientHeight),this.interval&&this.slides[this.index]===n&&this.play(),this.setTimeout(this.options.onslidecomplete,[e,n]))},onload:function(t){this.oncomplete(t)},onerror:function(t){this.oncomplete(t)},onkeydown:function(t){switch(t.which||t.keyCode){case 13:this.options.toggleControlsOnReturn&&(this.preventDefault(t),this.toggleControls());break;case 27:this.options.closeOnEscape&&(this.close(),t.stopImmediatePropagation());break;case 32:this.options.toggleSlideshowOnSpace&&(this.preventDefault(t),this.toggleSlideshow());break;case 37:this.options.enableKeyboardNavigation&&(this.preventDefault(t),this.prev());break;case 39:this.options.enableKeyboardNavigation&&(this.preventDefault(t),this.next())}},handleClick:function(t){function e(t){return i(n).hasClass(t)||i(o).hasClass(t)}var s=this.options,n=t.target||t.srcElement,o=n.parentNode;e(s.toggleClass)?(this.preventDefault(t),this.toggleControls()):e(s.prevClass)?(this.preventDefault(t),this.prev()):e(s.nextClass)?(this.preventDefault(t),this.next()):e(s.closeClass)?(this.preventDefault(t),this.close()):e(s.playPauseClass)?(this.preventDefault(t),this.toggleSlideshow()):o===this.slidesContainer[0]?s.closeOnSlideClick?(this.preventDefault(t),this.close()):s.toggleControlsOnSlideClick&&(this.preventDefault(t),this.toggleControls()):o.parentNode&&o.parentNode===this.slidesContainer[0]&&s.toggleControlsOnSlideClick&&(this.preventDefault(t),this.toggleControls())},onclick:function(t){return this.options.emulateTouchEvents&&this.touchDelta&&(Math.abs(this.touchDelta.x)>20||Math.abs(this.touchDelta.y)>20)?void delete this.touchDelta:this.handleClick(t)},updateEdgeClasses:function(t){t?this.container.removeClass(this.options.leftEdgeClass):this.container.addClass(this.options.leftEdgeClass),t===this.num-1?this.container.addClass(this.options.rightEdgeClass):this.container.removeClass(this.options.rightEdgeClass)},handleSlide:function(t){this.options.continuous||this.updateEdgeClasses(t),this.loadElements(t),this.options.unloadElements&&this.unloadElements(t),this.setTitle(t)},onslide:function(t){this.index=t,this.handleSlide(t),this.setTimeout(this.options.onslide,[t,this.slides[t]])},setTitle:function(t){var i=this.slides[t].firstChild,e=i.title||i.alt,s=this.titleElement;s.length&&(this.titleElement.empty(),e&&s[0].appendChild(document.createTextNode(e)))},setTimeout:function(t,i,e){var s=this;return t&&window.setTimeout(function(){t.apply(s,i||[])},e||0)},createElement:function(t,e){var s=this.album.renderItem(t,e);return i(s).addClass(this.options.slideContentClass),s},loadElement:function(t){this.elements[t]||(this.slides[t].firstChild?this.elements[t]=i(this.slides[t]).hasClass(this.options.slideErrorClass)?3:2:(this.elements[t]=1,i(this.slides[t]).addClass(this.options.slideLoadingClass),this.slides[t].appendChild(this.createElement(this.list[t],this.proxyListener))))},loadElements:function(t){var i,e=Math.min(this.num,2*this.options.preloadRange+1),s=t;for(i=0;i<e;i+=1)s+=i*(i%2===0?-1:1),s=this.circle(s),this.loadElement(s)},unloadElements:function(t){var i,e;for(i in this.elements)this.elements.hasOwnProperty(i)&&(e=Math.abs(t-i),e>this.options.preloadRange&&e+this.options.preloadRange<this.num&&(this.unloadSlide(i),delete this.elements[i]))},addSlide:function(t){var i=this.slidePrototype.cloneNode(!1);i.setAttribute("data-index",t),this.slidesContainer[0].appendChild(i),this.slides.push(i)},positionSlide:function(t){var i=this.slides[t];i.style.width=this.slideWidth+"px",this.support.transform&&(i.style.left=t*-this.slideWidth+"px",this.move(t,this.index>t?-this.slideWidth:this.index<t?this.slideWidth:0,0))},initSlides:function(t){var e,s;for(t||(this.positions=[],this.positions.length=this.num,this.elements={},this.imagePrototype=document.createElement("img"),this.elementPrototype=document.createElement("div"),this.slidePrototype=document.createElement("div"),i(this.slidePrototype).addClass(this.options.slideClass),this.slides=this.slidesContainer[0].children,e=this.options.clearSlides||this.slides.length!==this.num),this.slideWidth=this.container[0].clientWidth,this.slideHeight=this.container[0].clientHeight,this.slidesContainer[0].style.width=this.num*this.slideWidth+"px",e&&this.resetSlides(),s=0;s<this.num;s+=1)e&&this.addSlide(s),this.positionSlide(s);this.options.continuous&&this.support.transform&&(this.move(this.circle(this.index-1),-this.slideWidth,0),this.move(this.circle(this.index+1),this.slideWidth,0)),this.support.transform||(this.slidesContainer[0].style.left=this.index*-this.slideWidth+"px")},unloadSlide:function(t){var i,e;i=this.slides[t],e=i.firstChild,null!==e&&i.removeChild(e)},unloadAllSlides:function(){var t,i;for(t=0,i=this.slides.length;t<i;t++)this.unloadSlide(t)},toggleControls:function(){var t=this.options.controlsClass;this.container.hasClass(t)?this.container.removeClass(t):this.container.addClass(t)},toggleSlideshow:function(){this.interval?this.pause():this.play()},getNodeIndex:function(t){return parseInt(t.getAttribute("data-index"),10)},initStartIndex:function(){var t,i=this.album,e=this.options.index;if(e&&"number"!=typeof e)for(t=0;t<this.num;t+=1)if(this.list[t]===e||i.getItemUrl(this.list[t])===i.getItemUrl(e)){e=t;break}this.index=this.circle(parseInt(e,10)||0)},initEventListeners:function(){function t(t){var i=e.support.transition&&e.support.transition.end===t.type?"transitionend":t.type;e["on"+i](t)}var e=this,s=this.slidesContainer;i(window).on("resize",t),i(document.body).on("keydown",t),this.container.on("click",t),this.support.touch?s.on("touchstart touchmove touchend touchcancel",t):this.options.emulateTouchEvents&&this.support.transition&&s.on("mousedown mousemove mouseup mouseout",t),this.support.transition&&s.on(this.support.transition.end,t),this.proxyListener=t},destroyEventListeners:function(){var t=this.slidesContainer,e=this.proxyListener;i(window).off("resize",e),i(document.body).off("keydown",e),this.container.off("click",e),this.support.touch?t.off("touchstart touchmove touchend touchcancel",e):this.options.emulateTouchEvents&&this.support.transition&&t.off("mousedown mousemove mouseup mouseout",e),this.support.transition&&t.off(this.support.transition.end,e)},handleOpen:function(){this.options.onopened&&this.options.onopened.call(this)},initWidget:function(){function t(i){i.target===e.container[0]&&(e.container.off(e.support.transition.end,t),e.handleOpen())}var e=this;return this.container=i(this.options.container),this.container.length?(this.slidesContainer=this.container.find(this.options.slidesContainer).first(),this.slidesContainer.length?(this.titleElement=this.container.find(this.options.titleElement).first(),1===this.num&&this.container.addClass(this.options.singleClass),this.options.onopen&&this.options.onopen.call(this),this.support.transition&&this.options.displayTransition?this.container.on(this.support.transition.end,t):this.handleOpen(),this.options.hidePageScrollbars&&(this.bodyOverflowStyle=document.body.style.overflow,document.body.style.overflow="hidden"),this.container[0].style.display="block",this.initSlides(),void this.container.addClass(this.options.displayClass)):(this.console.log("blueimp Gallery: Slides container not found.",this.options.slidesContainer),!1)):(this.console.log("blueimp Gallery: Widget container not found.",this.options.container),!1)},initOptions:function(i){this.overrided(t.mixin({},s.prototype.options,i)),this.num<3&&(this.options.continuous=!!this.options.continuous&&null),this.support.transition||(this.options.emulateTouchEvents=!1),this.options.event&&this.preventDefault(this.options.event)}});return e.installPlugin("views",{name:"slider",ctor:s,templates:{"default":'<div class="slides"></div><h3 class="title"></h3><a class="prev">‹</a><a class="next">›</a><a class="close">×</a><a class="play-pause"></a><ol class="indicator"></ol>'}}),e.SliderView=s}),t("skylark-ui-album/plugins/views/CarouselView",["../../Album","./SliderView"],function(t,i){var e=i.inherit({klassName:"CarouselView",options:{hidePageScrollbars:!1,toggleControlsOnReturn:!1,toggleSlideshowOnSpace:!1,enableKeyboardNavigation:!1,closeOnEscape:!1,closeOnSlideClick:!1,closeOnSwipeUpOrDown:!1,disableScroll:!1,startSlideshow:!0},initOptions:function(t){var t=langx.mixin({},e.prototype.options,t);this.overrided(t)}});return t.installPlugin("views",{
name:"carousel",ctor:e,templates:{"default":'<div class="slides"></div><h3 class="title"></h3><a class="prev">‹</a><a class="next">›</a><a class="close">×</a><a class="play-pause"></a><ol class="indicator"></ol>'}}),e}),t("skylark-ui-album/plugins/views/LightBoxView",["skylark-langx/langx","../../Album","./SliderView"],function(t,i,e){var s=e.inherit({klassName:"LightBoxView",options:{hidePageScrollbars:!1,indicatorContainer:"ol",activeIndicatorClass:"active",thumbnailProperty:"thumbnail",thumbnailIndicators:!0},initOptions:function(i){var i=t.mixin({},s.prototype.options,i);this.overrided(i)},createIndicator:function(t){var e,s,n=this.album,o=this.indicatorPrototype.cloneNode(!1),a=n.getItemTitle(t),r=this.options.thumbnailProperty;return this.options.thumbnailIndicators&&(r&&(e=i.getItemProperty(t,r)),void 0===e&&(s=t.getElementsByTagName&&$(t).find("img")[0],s&&(e=s.src)),e&&(o.style.backgroundImage='url("'+e+'")')),a&&(o.title=a),o},addIndicator:function(t){if(this.indicatorContainer.length){var i=this.createIndicator(this.list[t]);i.setAttribute("data-index",t),this.indicatorContainer[0].appendChild(i),this.indicators.push(i)}},setActiveIndicator:function(t){this.indicators&&(this.activeIndicator&&this.activeIndicator.removeClass(this.options.activeIndicatorClass),this.activeIndicator=$(this.indicators[t]),this.activeIndicator.addClass(this.options.activeIndicatorClass))},initSlides:function(t){t||(this.indicatorContainer=this.container.find(this.options.indicatorContainer),this.indicatorContainer.length&&(this.indicatorPrototype=document.createElement("li"),this.indicators=this.indicatorContainer[0].children)),this.overrided(t)},addSlide:function(t){this.overrided(t),this.addIndicator(t)},resetSlides:function(){this.overrided(),this.indicatorContainer.empty(),this.indicators=[]},handleClick:function(t){var i=t.target||t.srcElement,e=i.parentNode;if(e===this.indicatorContainer[0])this.preventDefault(t),this.slide(this.getNodeIndex(i));else{if(e.parentNode!==this.indicatorContainer[0])return this.overrided(t);this.preventDefault(t),this.slide(this.getNodeIndex(e))}},handleSlide:function(t){this.overrided(t),this.setActiveIndicator(t)},handleClose:function(){this.activeIndicator&&this.activeIndicator.removeClass(this.options.activeIndicatorClass),this.overrided()}});return i.installPlugin("views",{name:"lightbox",ctor:s,templates:{"default":'<div class="slides"></div><h3 class="title"></h3><a class="prev">‹</a><a class="next">›</a><a class="close">×</a><ol class="indicator"></ol>'}}),s}),t("skylark-ui-album/main",["./Album","./helper","./plugins/items/image","./plugins/items/video","./plugins/items/vimeo","./plugins/items/youtube","./plugins/views/SliderView","./plugins/views/CarouselView","./plugins/views/LightBoxView"],function(t){return t}),t("skylark-ui-album",["skylark-ui-album/main"],function(t){return t})},this);
//# sourceMappingURL=sourcemaps/skylark-ui-album.js.map
